<!DOCTYPE html>
<html>
<head>
  <title>jquery.sparkline.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../doc-style.css" />
  <script src="../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../";
    var thisFile = "public\\modules\\jquery-sparkline\\jquery.sparkline.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>jquery.sparkline.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>
<div class="dox">
<div class="summary">
<p>jquery.sparkline.js</p>
</div>
<div class="body">
<p>v2.4.1
(c) Splunk, Inc
Contact: Gareth Watts (gareth@splunk.com)
http://omnipotent.net/jquery.sparkline/</p>
<p>Generates inline sparkline charts from data supplied either to the method
or inline in HTML</p>
<p>Compatible with Internet Explorer 6.0+ and modern browsers equipped with the canvas tag
(Firefox 2.0+, Safari, Opera, etc)</p>
<p>License: New BSD License</p>
<p>Copyright (c) 2012, Splunk Inc.
All rights reserved.</p>
<p>Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:</p>
<pre><code>* Redistributions of source code must retain the above copyright notice,
  this list of conditions and the following disclaimer.
* Redistributions in binary form must reproduce the above copyright notice,
  this list of conditions and the following disclaimer in the documentation
  and/or other materials provided with the distribution.
* Neither the name of Splunk Inc nor the names of its contributors may
  be used to endorse or promote products derived from this software without
  specific prior written permission.
</code></pre>
<p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT
OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
<p>Usage:
$(selector).sparkline(values, options)</p>
<p>If values is undefined or set to 'html' then the data values are read from the specified tag:</p>
  <p>Sparkline: <span class="sparkline">1,4,6,6,8,5,3,5</span></p>
  $('.sparkline').sparkline();
There must be no spaces in the enclosed data set
<p>Otherwise values must be an array of numbers or null values</p>
   <p>Sparkline: <span id="sparkline1">This text replaced if the browser is compatible</span></p>
   $('#sparkline1').sparkline([1,4,6,6,8,5,3,5])
   $('#sparkline2').sparkline([1,4,6,null,null,5,3,5])
<p>Values can also be specified in an HTML comment, or as a values attribute:</p>
   <p>Sparkline: <span class="sparkline"><!--1,4,6,6,8,5,3,5 --></span></p>
   <p>Sparkline: <span class="sparkline" values="1,4,6,6,8,5,3,5"></span></p>
   $('.sparkline').sparkline();
<p>For line charts, x values can also be specified:</p>
  <p>Sparkline: <span class="sparkline">1:1,2.7:4,3.4:6,5:6,6:8,8.7:5,9:3,10:5</span></p>
   $('#sparkline1').sparkline([ [1,1], [2.7,4], [3.4,6], [5,6], [6,8], [8.7,5], [9,3], [10,5] ])
<p>By default, options should be passed in as the second argument to the sparkline function:
$('.sparkline').sparkline([1,2,3,4], {type: 'bar'})</p>
<p>Options can also be set by passing them on the tag itself.  This feature is disabled by default though
as there's a slight performance overhead:
$('.sparkline').sparkline([1,2,3,4], {enableTagOptions: true})</p>
  <p>Sparkline: <span class="sparkline" sparkType="bar" sparkBarColor="red">loading</span></p>
Prefix all options supplied as tag attribute with "spark" (configurable by setting tagOptionsPrefix)
<p>Supported options:
lineColor - Color of the line used for the chart
fillColor - Color used to fill in the chart - Set to '' or false for a transparent chart
width - Width of the chart - Defaults to 3 times the number of values in pixels
height - Height of the chart - Defaults to the height of the containing element
chartRangeMin - Specify the minimum value to use for the Y range of the chart - Defaults to the minimum value supplied
chartRangeMax - Specify the maximum value to use for the Y range of the chart - Defaults to the maximum value supplied
chartRangeClip - Clip out of range values to the max/min specified by chartRangeMin and chartRangeMax
chartRangeMinX - Specify the minimum value to use for the X range of the chart - Defaults to the minimum value supplied
chartRangeMaxX - Specify the maximum value to use for the X range of the chart - Defaults to the maximum value supplied
composite - If true then don't erase any existing chart attached to the tag, but draw
another chart over the top - Note that width and height are ignored if an
existing chart is detected.
tagValuesAttribute - Name of tag attribute to check for data values - Defaults to 'values'
enableTagOptions - Whether to check tags for sparkline options
tagOptionsPrefix - Prefix used for options supplied as tag attributes - Defaults to 'spark'
disableHiddenCheck - If set to true, then the plugin will assume that charts will never be drawn into a
hidden dom element, avoding a browser reflow
disableInteraction - If set to true then all mouseover/click interaction behaviour will be disabled,
making the plugin perform much like it did in 1.x
disableTooltips - If set to true then tooltips will be disabled - Defaults to false (tooltips enabled)
disableHighlight - If set to true then highlighting of selected chart elements on mouseover will be disabled
defaults to false (highlights enabled)
highlightLighten - Factor to lighten/darken highlighted chart values by - Defaults to 1.4 for a 40% increase
tooltipContainer - Specify which DOM element the tooltip should be rendered into - defaults to document.body
tooltipClassname - Optional CSS classname to apply to tooltips - If not specified then a default style will be applied
tooltipOffsetX - How many pixels away from the mouse pointer to render the tooltip on the X axis
tooltipOffsetY - How many pixels away from the mouse pointer to render the tooltip on the r axis
tooltipFormatter  - Optional callback that allows you to override the HTML displayed in the tooltip
callback is given arguments of (sparkline, options, fields)
tooltipChartTitle - If specified then the tooltip uses the string specified by this setting as a title
tooltipFormat - A format string or SPFormat object  (or an array thereof for multiple entries)
to control the format of the tooltip
tooltipPrefix - A string to prepend to each field displayed in a tooltip
tooltipSuffix - A string to append to each field displayed in a tooltip
tooltipSkipNull - If true then null values will not have a tooltip displayed (defaults to true)
tooltipValueLookups - An object or range map to map field values to tooltip strings
(eg. to map -1 to &quot;Lost&quot;, 0 to &quot;Draw&quot;, and 1 to &quot;Win&quot;)
numberFormatter - Optional callback for formatting numbers in tooltips
numberDigitGroupSep - Character to use for group separator in numbers &quot;1,234&quot; - Defaults to &quot;,&quot;
numberDecimalMark - Character to use for the decimal point when formatting numbers - Defaults to &quot;.&quot;
numberDigitGroupCount - Number of digits between group separator - Defaults to 3</p>
<p>There are 7 types of sparkline, selected by supplying a &quot;type&quot; option of 'line' (default),
'bar', 'tristate', 'bullet', 'discrete', 'pie' or 'box'
line - Line chart.  Options:
spotColor - Set to '' to not end each line in a circular spot
minSpotColor - If set, color of spot at minimum value
maxSpotColor - If set, color of spot at maximum value
spotRadius - Radius in pixels
lineWidth - Width of line in pixels
normalRangeMin
normalRangeMax - If set draws a filled horizontal bar between these two values marking the &quot;normal&quot;
or expected range of values
normalRangeColor - Color to use for the above bar
drawNormalOnTop - Draw the normal range above the chart fill color if true
defaultPixelsPerValue - Defaults to 3 pixels of width for each value in the chart
highlightSpotColor - The color to use for drawing a highlight spot on mouseover - Set to null to disable
highlightLineColor - The color to use for drawing a highlight line on mouseover - Set to null to disable
valueSpots - Specify which points to draw spots on, and in which color.  Accepts a range map</p>
<p>bar - Bar chart.  Options:
barColor - Color of bars for postive values
negBarColor - Color of bars for negative values
zeroColor - Color of bars with zero values
nullColor - Color of bars with null values - Defaults to omitting the bar entirely
barWidth - Width of bars in pixels
colorMap - Optional mappnig of values to colors to override the *BarColor values above
can be an Array of values to control the color of individual bars or a range map
to specify colors for individual ranges of values
barSpacing - Gap between bars in pixels
zeroAxis - Centers the y-axis around zero if true</p>
<p>tristate - Charts values of win (&gt;0), lose (&lt;0) or draw (=0)
posBarColor - Color of win values
negBarColor - Color of lose values
zeroBarColor - Color of draw values
barWidth - Width of bars in pixels
barSpacing - Gap between bars in pixels
colorMap - Optional mappnig of values to colors to override the *BarColor values above
can be an Array of values to control the color of individual bars or a range map
to specify colors for individual ranges of values</p>
<p>discrete - Options:
lineHeight - Height of each line in pixels - Defaults to 30% of the graph height
thesholdValue - Values less than this value will be drawn using thresholdColor instead of lineColor
thresholdColor</p>
<p>bullet - Values for bullet graphs msut be in the order: target, performance, range1, range2, range3, ...
options:
targetColor - The color of the vertical target marker
targetWidth - The width of the target marker in pixels
performanceColor - The color of the performance measure horizontal bar
rangeColors - Colors to use for each qualitative range background color</p>
<p>pie - Pie chart. Options:
sliceColors - An array of colors to use for pie slices
offset - Angle in degrees to offset the first slice - Try -90 or +90
borderWidth - Width of border to draw around the pie chart, in pixels - Defaults to 0 (no border)
borderColor - Color to use for the pie chart border - Defaults to #000</p>
<p>box - Box plot. Options:
raw - Set to true to supply pre-computed plot points as values
values should be: low_outlier, low_whisker, q1, median, q3, high_whisker, high_outlier
When set to false you can supply any number of values and the box plot will
be computed for you.  Default is false.
showOutliers - Set to true (default) to display outliers as circles
outlierIQR - Interquartile range used to determine outliers.  Default 1.5
boxLineColor - Outline color of the box
boxFillColor - Fill color for the box
whiskerColor - Line color used for whiskers
outlierLineColor - Outline color of outlier circles
outlierFillColor - Fill color of the outlier circles
spotRadius - Radius of outlier circles
medianColor - Line color of the median line
target - Draw a target cross hair at the supplied value (default undefined)</p>
<p>Examples:
$('#sparkline1').sparkline(myvalues, { lineColor: '#f00', fillColor: false });
$('.barsparks').sparkline('html', { type:'bar', height:'40px', barWidth:5 });
$('#tristate').sparkline([1,1,-1,1,0,0,-1], { type:'tristate' }):
$('#discrete').sparkline([1,3,4,5,5,3,4,5], { type:'discrete' });
$('#bullet').sparkline([10,12,12,9,7], { type:'bullet' });
$('#pie').sparkline([1,1,2], { type:'pie' });</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-comment">/*jslint regexp: true, browser: true, jquery: true, white: true, nomen: false, plusplus: false, maxerr: 500, indent: 4 */</span>

(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">document, Math, undefined</span>) </span>{ <span class="hljs-comment">// performance/minified-size optimization</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">factory</span>) </span>{
    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> define === <span class="hljs-string">'function'</span> &amp;&amp; define.amd) {
        define([<span class="hljs-string">'jquery'</span>], factory);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (jQuery &amp;&amp; !jQuery.fn.sparkline) {
        factory(jQuery);
    }
}
(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$</span>) </span>{
    <span class="hljs-string">'use strict'</span>;

    <span class="hljs-keyword">var</span> UNSET_OPTION = {},
        getDefaults, createClass, SPFormat, clipval, quartile, normalizeValue, normalizeValues,
        remove, isNumber, all, sum, addCSS, ensureArray, formatNumber, RangeMap,
        MouseHandler, Tooltip, barHighlightMixin,
        line, bar, tristate, discrete, bullet, pie, box, defaultStyles, initStyles,
        VShape, VCanvas_base, VCanvas_canvas, VCanvas_vml, pending, shapeCount = <span class="hljs-number">0</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<div class="dox">
<div class="summary">
<p>Default configuration settings</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">    getDefaults = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>Settings common to most/all chart types</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            common: {
                <span class="hljs-attr">type</span>: <span class="hljs-string">'line'</span>,
                <span class="hljs-attr">lineColor</span>: <span class="hljs-string">'#00f'</span>,
                <span class="hljs-attr">fillColor</span>: <span class="hljs-string">'#cdf'</span>,
                <span class="hljs-attr">defaultPixelsPerValue</span>: <span class="hljs-number">3</span>,
                <span class="hljs-attr">width</span>: <span class="hljs-string">'auto'</span>,
                <span class="hljs-attr">height</span>: <span class="hljs-string">'auto'</span>,
                <span class="hljs-attr">composite</span>: <span class="hljs-literal">false</span>,
                <span class="hljs-attr">tagValuesAttribute</span>: <span class="hljs-string">'values'</span>,
                <span class="hljs-attr">tagOptionsPrefix</span>: <span class="hljs-string">'spark'</span>,
                <span class="hljs-attr">enableTagOptions</span>: <span class="hljs-literal">false</span>,
                <span class="hljs-attr">enableHighlight</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">highlightLighten</span>: <span class="hljs-number">1.4</span>,
                <span class="hljs-attr">tooltipSkipNull</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">tooltipPrefix</span>: <span class="hljs-string">''</span>,
                <span class="hljs-attr">tooltipSuffix</span>: <span class="hljs-string">''</span>,
                <span class="hljs-attr">disableHiddenCheck</span>: <span class="hljs-literal">false</span>,
                <span class="hljs-attr">numberFormatter</span>: <span class="hljs-literal">false</span>,
                <span class="hljs-attr">numberDigitGroupCount</span>: <span class="hljs-number">3</span>,
                <span class="hljs-attr">numberDigitGroupSep</span>: <span class="hljs-string">','</span>,
                <span class="hljs-attr">numberDecimalMark</span>: <span class="hljs-string">'.'</span>,
                <span class="hljs-attr">disableTooltips</span>: <span class="hljs-literal">false</span>,
                <span class="hljs-attr">disableInteraction</span>: <span class="hljs-literal">false</span>
            },
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>Defaults for line charts</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            line: {
                <span class="hljs-attr">spotColor</span>: <span class="hljs-string">'#f80'</span>,
                <span class="hljs-attr">highlightSpotColor</span>: <span class="hljs-string">'#5f5'</span>,
                <span class="hljs-attr">highlightLineColor</span>: <span class="hljs-string">'#f22'</span>,
                <span class="hljs-attr">spotRadius</span>: <span class="hljs-number">1.5</span>,
                <span class="hljs-attr">minSpotColor</span>: <span class="hljs-string">'#f80'</span>,
                <span class="hljs-attr">maxSpotColor</span>: <span class="hljs-string">'#f80'</span>,
                <span class="hljs-attr">lineWidth</span>: <span class="hljs-number">1</span>,
                <span class="hljs-attr">normalRangeMin</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">normalRangeMax</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">normalRangeColor</span>: <span class="hljs-string">'#ccc'</span>,
                <span class="hljs-attr">drawNormalOnTop</span>: <span class="hljs-literal">false</span>,
                <span class="hljs-attr">chartRangeMin</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">chartRangeMax</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">chartRangeMinX</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">chartRangeMaxX</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">tooltipFormat</span>: <span class="hljs-keyword">new</span> SPFormat(<span class="hljs-string">'&lt;span style="color: {{color}}"&gt;&amp;#9679;&lt;/span&gt; {{prefix}}{{y}}{{suffix}}'</span>)
            },
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>Defaults for bar charts</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            bar: {
                <span class="hljs-attr">barColor</span>: <span class="hljs-string">'#3366cc'</span>,
                <span class="hljs-attr">negBarColor</span>: <span class="hljs-string">'#f44'</span>,
                <span class="hljs-attr">stackedBarColor</span>: [<span class="hljs-string">'#3366cc'</span>, <span class="hljs-string">'#dc3912'</span>, <span class="hljs-string">'#ff9900'</span>, <span class="hljs-string">'#109618'</span>, <span class="hljs-string">'#66aa00'</span>,
                    <span class="hljs-string">'#dd4477'</span>, <span class="hljs-string">'#0099c6'</span>, <span class="hljs-string">'#990099'</span>],
                <span class="hljs-attr">zeroColor</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">nullColor</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">zeroAxis</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">barWidth</span>: <span class="hljs-number">4</span>,
                <span class="hljs-attr">barSpacing</span>: <span class="hljs-number">1</span>,
                <span class="hljs-attr">chartRangeMax</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">chartRangeMin</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">chartRangeClip</span>: <span class="hljs-literal">false</span>,
                <span class="hljs-attr">colorMap</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">tooltipFormat</span>: <span class="hljs-keyword">new</span> SPFormat(<span class="hljs-string">'&lt;span style="color: {{color}}"&gt;&amp;#9679;&lt;/span&gt; {{prefix}}{{value}}{{suffix}}'</span>)
            },
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>Defaults for tristate charts</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            tristate: {
                <span class="hljs-attr">barWidth</span>: <span class="hljs-number">4</span>,
                <span class="hljs-attr">barSpacing</span>: <span class="hljs-number">1</span>,
                <span class="hljs-attr">posBarColor</span>: <span class="hljs-string">'#6f6'</span>,
                <span class="hljs-attr">negBarColor</span>: <span class="hljs-string">'#f44'</span>,
                <span class="hljs-attr">zeroBarColor</span>: <span class="hljs-string">'#999'</span>,
                <span class="hljs-attr">colorMap</span>: {},
                <span class="hljs-attr">tooltipFormat</span>: <span class="hljs-keyword">new</span> SPFormat(<span class="hljs-string">'&lt;span style="color: {{color}}"&gt;&amp;#9679;&lt;/span&gt; {{value:map}}'</span>),
                <span class="hljs-attr">tooltipValueLookups</span>: { <span class="hljs-attr">map</span>: { <span class="hljs-string">'-1'</span>: <span class="hljs-string">'Loss'</span>, <span class="hljs-string">'0'</span>: <span class="hljs-string">'Draw'</span>, <span class="hljs-string">'1'</span>: <span class="hljs-string">'Win'</span> } }
            },
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>Defaults for discrete charts</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            discrete: {
                <span class="hljs-attr">lineHeight</span>: <span class="hljs-string">'auto'</span>,
                <span class="hljs-attr">thresholdColor</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">thresholdValue</span>: <span class="hljs-number">0</span>,
                <span class="hljs-attr">chartRangeMax</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">chartRangeMin</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">chartRangeClip</span>: <span class="hljs-literal">false</span>,
                <span class="hljs-attr">tooltipFormat</span>: <span class="hljs-keyword">new</span> SPFormat(<span class="hljs-string">'{{prefix}}{{value}}{{suffix}}'</span>)
            },
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>Defaults for bullet charts</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            bullet: {
                <span class="hljs-attr">targetColor</span>: <span class="hljs-string">'#f33'</span>,
                <span class="hljs-attr">targetWidth</span>: <span class="hljs-number">3</span>, <span class="hljs-comment">// width of the target bar in pixels</span>
                <span class="hljs-attr">performanceColor</span>: <span class="hljs-string">'#33f'</span>,
                <span class="hljs-attr">rangeColors</span>: [<span class="hljs-string">'#d3dafe'</span>, <span class="hljs-string">'#a8b6ff'</span>, <span class="hljs-string">'#7f94ff'</span>],
                <span class="hljs-attr">base</span>: <span class="hljs-literal">undefined</span>, <span class="hljs-comment">// set this to a number to change the base start number</span>
                <span class="hljs-attr">tooltipFormat</span>: <span class="hljs-keyword">new</span> SPFormat(<span class="hljs-string">'{{fieldkey:fields}} - {{value}}'</span>),
                <span class="hljs-attr">tooltipValueLookups</span>: { <span class="hljs-attr">fields</span>: {<span class="hljs-attr">r</span>: <span class="hljs-string">'Range'</span>, <span class="hljs-attr">p</span>: <span class="hljs-string">'Performance'</span>, <span class="hljs-attr">t</span>: <span class="hljs-string">'Target'</span>} }
            },
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>Defaults for pie charts</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            pie: {
                <span class="hljs-attr">offset</span>: <span class="hljs-number">0</span>,
                <span class="hljs-attr">sliceColors</span>: [<span class="hljs-string">'#3366cc'</span>, <span class="hljs-string">'#dc3912'</span>, <span class="hljs-string">'#ff9900'</span>, <span class="hljs-string">'#109618'</span>, <span class="hljs-string">'#66aa00'</span>,
                    <span class="hljs-string">'#dd4477'</span>, <span class="hljs-string">'#0099c6'</span>, <span class="hljs-string">'#990099'</span>],
                <span class="hljs-attr">borderWidth</span>: <span class="hljs-number">0</span>,
                <span class="hljs-attr">borderColor</span>: <span class="hljs-string">'#000'</span>,
                <span class="hljs-attr">tooltipFormat</span>: <span class="hljs-keyword">new</span> SPFormat(<span class="hljs-string">'&lt;span style="color: {{color}}"&gt;&amp;#9679;&lt;/span&gt; {{value}} ({{percent.1}}%)'</span>)
            },
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>Defaults for box plots</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            box: {
                <span class="hljs-attr">raw</span>: <span class="hljs-literal">false</span>,
                <span class="hljs-attr">boxLineColor</span>: <span class="hljs-string">'#000'</span>,
                <span class="hljs-attr">boxFillColor</span>: <span class="hljs-string">'#cdf'</span>,
                <span class="hljs-attr">whiskerColor</span>: <span class="hljs-string">'#000'</span>,
                <span class="hljs-attr">outlierLineColor</span>: <span class="hljs-string">'#333'</span>,
                <span class="hljs-attr">outlierFillColor</span>: <span class="hljs-string">'#fff'</span>,
                <span class="hljs-attr">medianColor</span>: <span class="hljs-string">'#f00'</span>,
                <span class="hljs-attr">showOutliers</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">outlierIQR</span>: <span class="hljs-number">1.5</span>,
                <span class="hljs-attr">spotRadius</span>: <span class="hljs-number">1.5</span>,
                <span class="hljs-attr">target</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">targetColor</span>: <span class="hljs-string">'#4a2'</span>,
                <span class="hljs-attr">chartRangeMax</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">chartRangeMin</span>: <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">tooltipFormat</span>: <span class="hljs-keyword">new</span> SPFormat(<span class="hljs-string">'{{field:fields}}: {{value}}'</span>),
                <span class="hljs-attr">tooltipFormatFieldlistKey</span>: <span class="hljs-string">'field'</span>,
                <span class="hljs-attr">tooltipValueLookups</span>: { <span class="hljs-attr">fields</span>: { <span class="hljs-attr">lq</span>: <span class="hljs-string">'Lower Quartile'</span>, <span class="hljs-attr">med</span>: <span class="hljs-string">'Median'</span>,
                    <span class="hljs-attr">uq</span>: <span class="hljs-string">'Upper Quartile'</span>, <span class="hljs-attr">lo</span>: <span class="hljs-string">'Left Outlier'</span>, <span class="hljs-attr">ro</span>: <span class="hljs-string">'Right Outlier'</span>,
                    <span class="hljs-attr">lw</span>: <span class="hljs-string">'Left Whisker'</span>, <span class="hljs-attr">rw</span>: <span class="hljs-string">'Right Whisker'</span>} }
            }
        };
    };

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>You can have tooltips use a css class other than jqstooltip by specifying tooltipClassname</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    defaultStyles = <span class="hljs-string">'.jqstooltip { '</span> +
            <span class="hljs-string">'position: absolute;'</span> +
            <span class="hljs-string">'left: 0px;'</span> +
            <span class="hljs-string">'top: 0px;'</span> +
            <span class="hljs-string">'visibility: hidden;'</span> +
            <span class="hljs-string">'background: rgb(0, 0, 0) transparent;'</span> +
            <span class="hljs-string">'background-color: rgba(0,0,0,0.6);'</span> +
            <span class="hljs-string">'filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);'</span> +
            <span class="hljs-string">'-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";'</span> +
            <span class="hljs-string">'color: white;'</span> +
            <span class="hljs-string">'font: 10px arial, san serif;'</span> +
            <span class="hljs-string">'text-align: left;'</span> +
            <span class="hljs-string">'white-space: nowrap;'</span> +
            <span class="hljs-string">'padding: 5px;'</span> +
            <span class="hljs-string">'border: 1px solid white;'</span> +
            <span class="hljs-string">'box-sizing: content-box;'</span> +
            <span class="hljs-string">'z-index: 10000;'</span> +
            <span class="hljs-string">'}'</span> +
            <span class="hljs-string">'.jqsfield { '</span> +
            <span class="hljs-string">'color: white;'</span> +
            <span class="hljs-string">'font: 10px arial, san serif;'</span> +
            <span class="hljs-string">'text-align: left;'</span> +
            <span class="hljs-string">'}'</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<div class="dox">
<div class="summary">
<p>Utilities</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
    createClass = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-regexp">/* [baseclass, [mixin, ...]], definition */</span></span>) </span>{
        <span class="hljs-keyword">var</span> Class, args;
        Class = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">this</span>.init.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
        };
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length &gt; <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>]) {
                Class.prototype = $.extend(<span class="hljs-keyword">new</span> <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>](), <span class="hljs-built_in">arguments</span>[<span class="hljs-built_in">arguments</span>.length - <span class="hljs-number">1</span>]);
                Class._super = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>].prototype;
            } <span class="hljs-keyword">else</span> {
                Class.prototype = <span class="hljs-built_in">arguments</span>[<span class="hljs-built_in">arguments</span>.length - <span class="hljs-number">1</span>];
            }
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length &gt; <span class="hljs-number">2</span>) {
                args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>, <span class="hljs-number">-1</span>);
                args.unshift(Class.prototype);
                $.extend.apply($, args);
            }
        } <span class="hljs-keyword">else</span> {
            Class.prototype = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>];
        }
        Class.prototype.cls = Class;
        <span class="hljs-keyword">return</span> Class;
    };

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<div class="dox">
<div class="summary">
<p>Wraps a format string for tooltips
{{x}}
{{x.2}
{{x:months}}</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">    $.SPFormatClass = SPFormat = createClass({
        <span class="hljs-attr">fre</span>: <span class="hljs-regexp">/\{\{([\w.]+?)(:(.+?))?\}\}/g</span>,
        <span class="hljs-attr">precre</span>: <span class="hljs-regexp">/(\w+)\.(\d+)/</span>,

        <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">format, fclass</span>) </span>{
            <span class="hljs-keyword">this</span>.format = format;
            <span class="hljs-keyword">this</span>.fclass = fclass;
        },

        <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">fieldset, lookups, options</span>) </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
                fields = fieldset,
                match, token, lookupkey, fieldvalue, prec;
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format.replace(<span class="hljs-keyword">this</span>.fre, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">var</span> lookup;
                token = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>];
                lookupkey = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">3</span>];
                match = self.precre.exec(token);
                <span class="hljs-keyword">if</span> (match) {
                    prec = match[<span class="hljs-number">2</span>];
                    token = match[<span class="hljs-number">1</span>];
                } <span class="hljs-keyword">else</span> {
                    prec = <span class="hljs-literal">false</span>;
                }
                fieldvalue = fields[token];
                <span class="hljs-keyword">if</span> (fieldvalue === <span class="hljs-literal">undefined</span>) {
                    <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
                }
                <span class="hljs-keyword">if</span> (lookupkey &amp;&amp; lookups &amp;&amp; lookups[lookupkey]) {
                    lookup = lookups[lookupkey];
                    <span class="hljs-keyword">if</span> (lookup.get) { <span class="hljs-comment">// RangeMap</span>
                        <span class="hljs-keyword">return</span> lookups[lookupkey].get(fieldvalue) || fieldvalue;
                    } <span class="hljs-keyword">else</span> {
                        <span class="hljs-keyword">return</span> lookups[lookupkey][fieldvalue] || fieldvalue;
                    }
                }
                <span class="hljs-keyword">if</span> (isNumber(fieldvalue)) {
                    <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'numberFormatter'</span>)) {
                        fieldvalue = options.get(<span class="hljs-string">'numberFormatter'</span>)(fieldvalue);
                    } <span class="hljs-keyword">else</span> {
                        fieldvalue = formatNumber(fieldvalue, prec,
                            options.get(<span class="hljs-string">'numberDigitGroupCount'</span>),
                            options.get(<span class="hljs-string">'numberDigitGroupSep'</span>),
                            options.get(<span class="hljs-string">'numberDecimalMark'</span>));
                    }
                }
                <span class="hljs-keyword">return</span> fieldvalue;
            });
        }
    });

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>convience method to avoid needing the new operator</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    $.spformat = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">format, fclass</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> SPFormat(format, fclass);
    };

    clipval = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">val, min, max</span>) </span>{
        <span class="hljs-keyword">if</span> (val &lt; min) {
            <span class="hljs-keyword">return</span> min;
        }
        <span class="hljs-keyword">if</span> (val &gt; max) {
            <span class="hljs-keyword">return</span> max;
        }
        <span class="hljs-keyword">return</span> val;
    };

    quartile = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">values, q</span>) </span>{
        <span class="hljs-keyword">var</span> vl;
        <span class="hljs-keyword">if</span> (q === <span class="hljs-number">2</span>) {
            vl = <span class="hljs-built_in">Math</span>.floor(values.length / <span class="hljs-number">2</span>);
            <span class="hljs-keyword">return</span> values.length % <span class="hljs-number">2</span> ? values[vl] : (values[vl<span class="hljs-number">-1</span>] + values[vl]) / <span class="hljs-number">2</span>;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (values.length % <span class="hljs-number">2</span> ) { <span class="hljs-comment">// odd</span>
                vl = (values.length * q + q) / <span class="hljs-number">4</span>;
                <span class="hljs-keyword">return</span> vl % <span class="hljs-number">1</span> ? (values[<span class="hljs-built_in">Math</span>.floor(vl)] + values[<span class="hljs-built_in">Math</span>.floor(vl) - <span class="hljs-number">1</span>]) / <span class="hljs-number">2</span> : values[vl<span class="hljs-number">-1</span>];
            } <span class="hljs-keyword">else</span> { <span class="hljs-comment">//even</span>
                vl = (values.length * q + <span class="hljs-number">2</span>) / <span class="hljs-number">4</span>;
                <span class="hljs-keyword">return</span> vl % <span class="hljs-number">1</span> ? (values[<span class="hljs-built_in">Math</span>.floor(vl)] + values[<span class="hljs-built_in">Math</span>.floor(vl) - <span class="hljs-number">1</span>]) / <span class="hljs-number">2</span> :  values[vl<span class="hljs-number">-1</span>];

            }
        }
    };

    normalizeValue = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">val</span>) </span>{
        <span class="hljs-keyword">var</span> nf;
        <span class="hljs-keyword">switch</span> (val) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">'undefined'</span>:
                val = <span class="hljs-literal">undefined</span>;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'null'</span>:
                val = <span class="hljs-literal">null</span>;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'true'</span>:
                val = <span class="hljs-literal">true</span>;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'false'</span>:
                val = <span class="hljs-literal">false</span>;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">default</span>:
                nf = <span class="hljs-built_in">parseFloat</span>(val);
                <span class="hljs-keyword">if</span> (val == nf) {
                    val = nf;
                }
        }
        <span class="hljs-keyword">return</span> val;
    };

    normalizeValues = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">vals</span>) </span>{
        <span class="hljs-keyword">var</span> i, result = [];
        <span class="hljs-keyword">for</span> (i = vals.length; i--;) {
            result[i] = normalizeValue(vals[i]);
        }
        <span class="hljs-keyword">return</span> result;
    };

    remove = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">vals, filter</span>) </span>{
        <span class="hljs-keyword">var</span> i, vl, result = [];
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, vl = vals.length; i &lt; vl; i++) {
            <span class="hljs-keyword">if</span> (vals[i] !== filter) {
                result.push(vals[i]);
            }
        }
        <span class="hljs-keyword">return</span> result;
    };

    isNumber = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">num</span>) </span>{
        <span class="hljs-keyword">return</span> !<span class="hljs-built_in">isNaN</span>(<span class="hljs-built_in">parseFloat</span>(num)) &amp;&amp; <span class="hljs-built_in">isFinite</span>(num);
    };

    formatNumber = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">num, prec, groupsize, groupsep, decsep</span>) </span>{
        <span class="hljs-keyword">var</span> p, i;
        num = (prec === <span class="hljs-literal">false</span> ? <span class="hljs-built_in">parseFloat</span>(num).toString() : num.toFixed(prec)).split(<span class="hljs-string">''</span>);
        p = (p = $.inArray(<span class="hljs-string">'.'</span>, num)) &lt; <span class="hljs-number">0</span> ? num.length : p;
        <span class="hljs-keyword">if</span> (p &lt; num.length) {
            num[p] = decsep;
        }
        <span class="hljs-keyword">for</span> (i = p - groupsize; i &gt; <span class="hljs-number">0</span>; i -= groupsize) {
            num.splice(i, <span class="hljs-number">0</span>, groupsep);
        }
        <span class="hljs-keyword">return</span> num.join(<span class="hljs-string">''</span>);
    };

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>determine if all values of an array match a value
returns true if the array is empty</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    all = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">val, arr, ignoreNull</span>) </span>{
        <span class="hljs-keyword">var</span> i;
        <span class="hljs-keyword">for</span> (i = arr.length; i--; ) {
            <span class="hljs-keyword">if</span> (ignoreNull &amp;&amp; arr[i] === <span class="hljs-literal">null</span>) <span class="hljs-keyword">continue</span>;
            <span class="hljs-keyword">if</span> (arr[i] !== val) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    };

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<p>sums the numeric values in an array, ignoring other values</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    sum = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">vals</span>) </span>{
        <span class="hljs-keyword">var</span> total = <span class="hljs-number">0</span>, i;
        <span class="hljs-keyword">for</span> (i = vals.length; i--;) {
            total += <span class="hljs-keyword">typeof</span> vals[i] === <span class="hljs-string">'number'</span> ? vals[i] : <span class="hljs-number">0</span>;
        }
        <span class="hljs-keyword">return</span> total;
    };

    ensureArray = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">val</span>) </span>{
        <span class="hljs-keyword">return</span> $.isArray(val) ? val : [val];
    };

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<p>http://paulirish.com/2008/bookmarklet-inject-new-css-rules/</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    addCSS = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">css</span>) </span>{
        <span class="hljs-keyword">var</span> tag, iefail;
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.createStyleSheet) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-built_in">document</span>.createStyleSheet().cssText = css;
                <span class="hljs-keyword">return</span>;
            } <span class="hljs-keyword">catch</span> (e) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<p>IE &lt;= 9 maxes out at 31 stylesheets; inject into page instead.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                iefail = <span class="hljs-literal">true</span>;
            }
        }
        tag = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'style'</span>);
        tag.type = <span class="hljs-string">'text/css'</span>;
        <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'head'</span>)[<span class="hljs-number">0</span>].appendChild(tag);
        <span class="hljs-keyword">if</span> (iefail) {
            <span class="hljs-built_in">document</span>.styleSheets[<span class="hljs-built_in">document</span>.styleSheets.length - <span class="hljs-number">1</span>].cssText = css;
        } <span class="hljs-keyword">else</span> {
            tag[(<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">document</span>.body.style.WebkitAppearance == <span class="hljs-string">'string'</span>) <span class="hljs-comment">/* webkit only */</span> ? <span class="hljs-string">'innerText'</span> : <span class="hljs-string">'innerHTML'</span>] = css;
        }
    };

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<p>Provide a cross-browser interface to a few simple drawing primitives</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    $.fn.simpledraw = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">width, height, useExisting, interact</span>) </span>{
        <span class="hljs-keyword">var</span> target, mhandler;
        <span class="hljs-keyword">if</span> (useExisting &amp;&amp; (target = <span class="hljs-keyword">this</span>.data(<span class="hljs-string">'_jqs_vcanvas'</span>))) {
            <span class="hljs-keyword">return</span> target;
        }

        <span class="hljs-keyword">if</span> ($.fn.sparkline.canvas === <span class="hljs-literal">false</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20"></a>
</div>
<p>We've already determined that neither Canvas nor VML are available</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ($.fn.sparkline.canvas === <span class="hljs-literal">undefined</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21"></a>
</div>
<p>No function defined yet -- need to see if we support Canvas or VML</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">var</span> el = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'canvas'</span>);
            <span class="hljs-keyword">if</span> (!!(el.getContext &amp;&amp; el.getContext(<span class="hljs-string">'2d'</span>))) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22"></a>
</div>
<p>Canvas is available</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                $.fn.sparkline.canvas = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">width, height, target, interact</span>) </span>{
                    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> VCanvas_canvas(width, height, target, interact);
                };
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.namespaces &amp;&amp; !<span class="hljs-built_in">document</span>.namespaces.v) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23"></a>
</div>
<p>VML is available</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                <span class="hljs-built_in">document</span>.namespaces.add(<span class="hljs-string">'v'</span>, <span class="hljs-string">'urn:schemas-microsoft-com:vml'</span>, <span class="hljs-string">'#default#VML'</span>);
                $.fn.sparkline.canvas = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">width, height, target, interact</span>) </span>{
                    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> VCanvas_vml(width, height, target);
                };
            } <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24"></a>
</div>
<p>Neither Canvas nor VML are available</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                $.fn.sparkline.canvas = <span class="hljs-literal">false</span>;
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
        }

        <span class="hljs-keyword">if</span> (width === <span class="hljs-literal">undefined</span>) {
            width = $(<span class="hljs-keyword">this</span>).innerWidth();
        }
        <span class="hljs-keyword">if</span> (height === <span class="hljs-literal">undefined</span>) {
            height = $(<span class="hljs-keyword">this</span>).innerHeight();
        }

        target = $.fn.sparkline.canvas(width, height, <span class="hljs-keyword">this</span>, interact);

        mhandler = $(<span class="hljs-keyword">this</span>).data(<span class="hljs-string">'_jqs_mhandler'</span>);
        <span class="hljs-keyword">if</span> (mhandler) {
            mhandler.registerCanvas(target);
        }
        <span class="hljs-keyword">return</span> target;
    };

    $.fn.cleardraw = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> target = <span class="hljs-keyword">this</span>.data(<span class="hljs-string">'_jqs_vcanvas'</span>);
        <span class="hljs-keyword">if</span> (target) {
            target.reset();
        }
    };

    $.RangeMapClass = RangeMap = createClass({
        <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">map</span>) </span>{
            <span class="hljs-keyword">var</span> key, range, rangelist = [];
            <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> map) {
                <span class="hljs-keyword">if</span> (map.hasOwnProperty(key) &amp;&amp; <span class="hljs-keyword">typeof</span> key === <span class="hljs-string">'string'</span> &amp;&amp; key.indexOf(<span class="hljs-string">':'</span>) &gt; <span class="hljs-number">-1</span>) {
                    range = key.split(<span class="hljs-string">':'</span>);
                    range[<span class="hljs-number">0</span>] = range[<span class="hljs-number">0</span>].length === <span class="hljs-number">0</span> ? -<span class="hljs-literal">Infinity</span> : <span class="hljs-built_in">parseFloat</span>(range[<span class="hljs-number">0</span>]);
                    range[<span class="hljs-number">1</span>] = range[<span class="hljs-number">1</span>].length === <span class="hljs-number">0</span> ? <span class="hljs-literal">Infinity</span> : <span class="hljs-built_in">parseFloat</span>(range[<span class="hljs-number">1</span>]);
                    range[<span class="hljs-number">2</span>] = map[key];
                    rangelist.push(range);
                }
            }
            <span class="hljs-keyword">this</span>.map = map;
            <span class="hljs-keyword">this</span>.rangelist = rangelist || <span class="hljs-literal">false</span>;
        },

        <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">value</span>) </span>{
            <span class="hljs-keyword">var</span> rangelist = <span class="hljs-keyword">this</span>.rangelist,
                i, range, result;
            <span class="hljs-keyword">if</span> ((result = <span class="hljs-keyword">this</span>.map[value]) !== <span class="hljs-literal">undefined</span>) {
                <span class="hljs-keyword">return</span> result;
            }
            <span class="hljs-keyword">if</span> (rangelist) {
                <span class="hljs-keyword">for</span> (i = rangelist.length; i--;) {
                    range = rangelist[i];
                    <span class="hljs-keyword">if</span> (range[<span class="hljs-number">0</span>] &lt;= value &amp;&amp; range[<span class="hljs-number">1</span>] &gt;= value) {
                        <span class="hljs-keyword">return</span> range[<span class="hljs-number">2</span>];
                    }
                }
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;
        }
    });

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-25" id="section-25"></a>
</div>
<p>Convenience function</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    $.range_map = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">map</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> RangeMap(map);
    };

    MouseHandler = createClass({
        <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el, options</span>) </span>{
            <span class="hljs-keyword">var</span> $el = $(el);
            <span class="hljs-keyword">this</span>.$el = $el;
            <span class="hljs-keyword">this</span>.options = options;
            <span class="hljs-keyword">this</span>.currentPageX = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">this</span>.currentPageY = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">this</span>.el = el;
            <span class="hljs-keyword">this</span>.splist = [];
            <span class="hljs-keyword">this</span>.tooltip = <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">this</span>.over = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">this</span>.displayTooltips = !options.get(<span class="hljs-string">'disableTooltips'</span>);
            <span class="hljs-keyword">this</span>.highlightEnabled = !options.get(<span class="hljs-string">'disableHighlight'</span>);
        },

        <span class="hljs-attr">registerSparkline</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">sp</span>) </span>{
            <span class="hljs-keyword">this</span>.splist.push(sp);
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.over) {
                <span class="hljs-keyword">this</span>.updateDisplay();
            }
        },

        <span class="hljs-attr">registerCanvas</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">canvas</span>) </span>{
            <span class="hljs-keyword">var</span> $canvas = $(canvas.canvas);
            <span class="hljs-keyword">this</span>.canvas = canvas;
            <span class="hljs-keyword">this</span>.$canvas = $canvas;
            $canvas.mouseenter($.proxy(<span class="hljs-keyword">this</span>.mouseenter, <span class="hljs-keyword">this</span>));
            $canvas.mouseleave($.proxy(<span class="hljs-keyword">this</span>.mouseleave, <span class="hljs-keyword">this</span>));
            $canvas.click($.proxy(<span class="hljs-keyword">this</span>.mouseclick, <span class="hljs-keyword">this</span>));
        },

        <span class="hljs-attr">reset</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">removeTooltip</span>) </span>{
            <span class="hljs-keyword">this</span>.splist = [];
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tooltip &amp;&amp; removeTooltip) {
                <span class="hljs-keyword">this</span>.tooltip.remove();
                <span class="hljs-keyword">this</span>.tooltip = <span class="hljs-literal">undefined</span>;
            }
        },

        <span class="hljs-attr">mouseclick</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
            <span class="hljs-keyword">var</span> clickEvent = $.Event(<span class="hljs-string">'sparklineClick'</span>);
            clickEvent.originalEvent = e;
            clickEvent.sparklines = <span class="hljs-keyword">this</span>.splist;
            <span class="hljs-keyword">this</span>.$el.trigger(clickEvent);
        },

        <span class="hljs-attr">mouseenter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
            $(<span class="hljs-built_in">document</span>.body).unbind(<span class="hljs-string">'mousemove.jqs'</span>);
            $(<span class="hljs-built_in">document</span>.body).bind(<span class="hljs-string">'mousemove.jqs'</span>, $.proxy(<span class="hljs-keyword">this</span>.mousemove, <span class="hljs-keyword">this</span>));
            <span class="hljs-keyword">this</span>.over = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">this</span>.currentPageX = e.pageX;
            <span class="hljs-keyword">this</span>.currentPageY = e.pageY;
            <span class="hljs-keyword">this</span>.currentEl = e.target;
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.tooltip &amp;&amp; <span class="hljs-keyword">this</span>.displayTooltips) {
                <span class="hljs-keyword">this</span>.tooltip = <span class="hljs-keyword">new</span> Tooltip(<span class="hljs-keyword">this</span>.options);
                <span class="hljs-keyword">this</span>.tooltip.updatePosition(e.pageX, e.pageY);
            }
            <span class="hljs-keyword">this</span>.updateDisplay();
        },

        <span class="hljs-attr">mouseleave</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            $(<span class="hljs-built_in">document</span>.body).unbind(<span class="hljs-string">'mousemove.jqs'</span>);
            <span class="hljs-keyword">var</span> splist = <span class="hljs-keyword">this</span>.splist,
                 spcount = splist.length,
                 needsRefresh = <span class="hljs-literal">false</span>,
                 sp, i;
            <span class="hljs-keyword">this</span>.over = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">this</span>.currentEl = <span class="hljs-literal">null</span>;

            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tooltip) {
                <span class="hljs-keyword">this</span>.tooltip.remove();
                <span class="hljs-keyword">this</span>.tooltip = <span class="hljs-literal">null</span>;
            }

            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; spcount; i++) {
                sp = splist[i];
                <span class="hljs-keyword">if</span> (sp.clearRegionHighlight()) {
                    needsRefresh = <span class="hljs-literal">true</span>;
                }
            }

            <span class="hljs-keyword">if</span> (needsRefresh) {
                <span class="hljs-keyword">this</span>.canvas.render();
            }
        },

        <span class="hljs-attr">mousemove</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
            <span class="hljs-keyword">this</span>.currentPageX = e.pageX;
            <span class="hljs-keyword">this</span>.currentPageY = e.pageY;
            <span class="hljs-keyword">this</span>.currentEl = e.target;
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tooltip) {
                <span class="hljs-keyword">this</span>.tooltip.updatePosition(e.pageX, e.pageY);
            }
            <span class="hljs-keyword">this</span>.updateDisplay();
        },

        <span class="hljs-attr">updateDisplay</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> splist = <span class="hljs-keyword">this</span>.splist,
                 spcount = splist.length,
                 needsRefresh = <span class="hljs-literal">false</span>,
                 offset = <span class="hljs-keyword">this</span>.$canvas.offset(),
                 localX = <span class="hljs-keyword">this</span>.currentPageX - offset.left,
                 localY = <span class="hljs-keyword">this</span>.currentPageY - offset.top,
                 tooltiphtml, sp, i, result, changeEvent;
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.over) {
                <span class="hljs-keyword">return</span>;
            }
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; spcount; i++) {
                sp = splist[i];
                result = sp.setRegionHighlight(<span class="hljs-keyword">this</span>.currentEl, localX, localY);
                <span class="hljs-keyword">if</span> (result) {
                    needsRefresh = <span class="hljs-literal">true</span>;
                }
            }
            <span class="hljs-keyword">if</span> (needsRefresh) {
                changeEvent = $.Event(<span class="hljs-string">'sparklineRegionChange'</span>);
                changeEvent.sparklines = <span class="hljs-keyword">this</span>.splist;
                <span class="hljs-keyword">this</span>.$el.trigger(changeEvent);
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tooltip) {
                    tooltiphtml = <span class="hljs-string">''</span>;
                    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; spcount; i++) {
                        sp = splist[i];
                        tooltiphtml += sp.getCurrentRegionTooltip();
                    }
                    <span class="hljs-keyword">this</span>.tooltip.setContent(tooltiphtml);
                }
                <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.disableHighlight) {
                    <span class="hljs-keyword">this</span>.canvas.render();
                }
            }
            <span class="hljs-keyword">if</span> (result === <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">this</span>.mouseleave();
            }
        }
    });


    Tooltip = createClass({
        <span class="hljs-attr">sizeStyle</span>: <span class="hljs-string">'position: static !important;'</span> +
            <span class="hljs-string">'display: block !important;'</span> +
            <span class="hljs-string">'visibility: hidden !important;'</span> +
            <span class="hljs-string">'float: left !important;'</span>,

        <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">options</span>) </span>{
            <span class="hljs-keyword">var</span> tooltipClassname = options.get(<span class="hljs-string">'tooltipClassname'</span>, <span class="hljs-string">'jqstooltip'</span>),
                sizetipStyle = <span class="hljs-keyword">this</span>.sizeStyle,
                offset;
            <span class="hljs-keyword">this</span>.container = options.get(<span class="hljs-string">'tooltipContainer'</span>) || <span class="hljs-built_in">document</span>.body;
            <span class="hljs-keyword">this</span>.tooltipOffsetX = options.get(<span class="hljs-string">'tooltipOffsetX'</span>, <span class="hljs-number">10</span>);
            <span class="hljs-keyword">this</span>.tooltipOffsetY = options.get(<span class="hljs-string">'tooltipOffsetY'</span>, <span class="hljs-number">12</span>);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26"></a>
</div>
<p>remove any previous lingering tooltip</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            $(<span class="hljs-string">'#jqssizetip'</span>).remove();
            $(<span class="hljs-string">'#jqstooltip'</span>).remove();
            <span class="hljs-keyword">this</span>.sizetip = $(<span class="hljs-string">'&lt;div/&gt;'</span>, {
                <span class="hljs-attr">id</span>: <span class="hljs-string">'jqssizetip'</span>,
                <span class="hljs-attr">style</span>: sizetipStyle,
                <span class="hljs-string">'class'</span>: tooltipClassname
            });
            <span class="hljs-keyword">this</span>.tooltip = $(<span class="hljs-string">'&lt;div/&gt;'</span>, {
                <span class="hljs-attr">id</span>: <span class="hljs-string">'jqstooltip'</span>,
                <span class="hljs-string">'class'</span>: tooltipClassname
            }).appendTo(<span class="hljs-keyword">this</span>.container);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27"></a>
</div>
<p>account for the container's location</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            offset = <span class="hljs-keyword">this</span>.tooltip.offset();
            <span class="hljs-keyword">this</span>.offsetLeft = offset.left;
            <span class="hljs-keyword">this</span>.offsetTop = offset.top;
            <span class="hljs-keyword">this</span>.hidden = <span class="hljs-literal">true</span>;
            $(<span class="hljs-built_in">window</span>).unbind(<span class="hljs-string">'resize.jqs scroll.jqs'</span>);
            $(<span class="hljs-built_in">window</span>).bind(<span class="hljs-string">'resize.jqs scroll.jqs'</span>, $.proxy(<span class="hljs-keyword">this</span>.updateWindowDims, <span class="hljs-keyword">this</span>));
            <span class="hljs-keyword">this</span>.updateWindowDims();
        },

        <span class="hljs-attr">updateWindowDims</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">this</span>.scrollTop = $(<span class="hljs-built_in">window</span>).scrollTop();
            <span class="hljs-keyword">this</span>.scrollLeft = $(<span class="hljs-built_in">window</span>).scrollLeft();
            <span class="hljs-keyword">this</span>.scrollRight = <span class="hljs-keyword">this</span>.scrollLeft + $(<span class="hljs-built_in">window</span>).width();
            <span class="hljs-keyword">this</span>.updatePosition();
        },

        <span class="hljs-attr">getSize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">content</span>) </span>{
            <span class="hljs-keyword">this</span>.sizetip.html(content).appendTo(<span class="hljs-keyword">this</span>.container);
            <span class="hljs-keyword">this</span>.width = <span class="hljs-keyword">this</span>.sizetip.width() + <span class="hljs-number">1</span>;
            <span class="hljs-keyword">this</span>.height = <span class="hljs-keyword">this</span>.sizetip.height();
            <span class="hljs-keyword">this</span>.sizetip.remove();
        },

        <span class="hljs-attr">setContent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">content</span>) </span>{
            <span class="hljs-keyword">if</span> (!content) {
                <span class="hljs-keyword">this</span>.tooltip.css(<span class="hljs-string">'visibility'</span>, <span class="hljs-string">'hidden'</span>);
                <span class="hljs-keyword">this</span>.hidden = <span class="hljs-literal">true</span>;
                <span class="hljs-keyword">return</span>;
            }
            <span class="hljs-keyword">this</span>.getSize(content);
            <span class="hljs-keyword">this</span>.tooltip.html(content)
                .css({
                    <span class="hljs-string">'width'</span>: <span class="hljs-keyword">this</span>.width,
                    <span class="hljs-string">'height'</span>: <span class="hljs-keyword">this</span>.height,
                    <span class="hljs-string">'visibility'</span>: <span class="hljs-string">'visible'</span>
                });
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.hidden) {
                <span class="hljs-keyword">this</span>.hidden = <span class="hljs-literal">false</span>;
                <span class="hljs-keyword">this</span>.updatePosition();
            }
        },

        <span class="hljs-attr">updatePosition</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">x, y</span>) </span>{
            <span class="hljs-keyword">if</span> (x === <span class="hljs-literal">undefined</span>) {
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.mousex === <span class="hljs-literal">undefined</span>) {
                    <span class="hljs-keyword">return</span>;
                }
                x = <span class="hljs-keyword">this</span>.mousex - <span class="hljs-keyword">this</span>.offsetLeft;
                y = <span class="hljs-keyword">this</span>.mousey - <span class="hljs-keyword">this</span>.offsetTop;

            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">this</span>.mousex = x = x - <span class="hljs-keyword">this</span>.offsetLeft;
                <span class="hljs-keyword">this</span>.mousey = y = y - <span class="hljs-keyword">this</span>.offsetTop;
            }
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.height || !<span class="hljs-keyword">this</span>.width || <span class="hljs-keyword">this</span>.hidden) {
                <span class="hljs-keyword">return</span>;
            }

            y -= <span class="hljs-keyword">this</span>.height + <span class="hljs-keyword">this</span>.tooltipOffsetY;
            x += <span class="hljs-keyword">this</span>.tooltipOffsetX;

            <span class="hljs-keyword">if</span> (y &lt; <span class="hljs-keyword">this</span>.scrollTop) {
                y = <span class="hljs-keyword">this</span>.scrollTop;
            }
            <span class="hljs-keyword">if</span> (x &lt; <span class="hljs-keyword">this</span>.scrollLeft) {
                x = <span class="hljs-keyword">this</span>.scrollLeft;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x + <span class="hljs-keyword">this</span>.width &gt; <span class="hljs-keyword">this</span>.scrollRight) {
                x = <span class="hljs-keyword">this</span>.scrollRight - <span class="hljs-keyword">this</span>.width;
            }

            <span class="hljs-keyword">this</span>.tooltip.css({
                <span class="hljs-string">'left'</span>: x,
                <span class="hljs-string">'top'</span>: y
            });
        },

        <span class="hljs-attr">remove</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">this</span>.tooltip.remove();
            <span class="hljs-keyword">this</span>.sizetip.remove();
            <span class="hljs-keyword">this</span>.sizetip = <span class="hljs-keyword">this</span>.tooltip = <span class="hljs-literal">undefined</span>;
            $(<span class="hljs-built_in">window</span>).unbind(<span class="hljs-string">'resize.jqs scroll.jqs'</span>);
        }
    });

    initStyles = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        addCSS(defaultStyles);
    };

    $(initStyles);

    pending = [];
    $.fn.sparkline = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">userValues, userOptions</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.each(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> options = <span class="hljs-keyword">new</span> $.fn.sparkline.options(<span class="hljs-keyword">this</span>, userOptions),
                 $<span class="hljs-keyword">this</span> = $(<span class="hljs-keyword">this</span>),
                 render, i;
            render = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">var</span> values, width, height, tmp, mhandler, sp, vals;
                <span class="hljs-keyword">if</span> (userValues === <span class="hljs-string">'html'</span> || userValues === <span class="hljs-literal">undefined</span>) {
                    vals = <span class="hljs-keyword">this</span>.getAttribute(options.get(<span class="hljs-string">'tagValuesAttribute'</span>));
                    <span class="hljs-keyword">if</span> (vals === <span class="hljs-literal">undefined</span> || vals === <span class="hljs-literal">null</span>) {
                        vals = $<span class="hljs-keyword">this</span>.html();
                    }
                    values = vals.replace(<span class="hljs-regexp">/(^\s*&lt;!--)|(--&gt;\s*$)|\s+/g</span>, <span class="hljs-string">''</span>).split(<span class="hljs-string">','</span>);
                } <span class="hljs-keyword">else</span> {
                    values = userValues;
                }

                width = options.get(<span class="hljs-string">'width'</span>) === <span class="hljs-string">'auto'</span> ? values.length * options.get(<span class="hljs-string">'defaultPixelsPerValue'</span>) : options.get(<span class="hljs-string">'width'</span>);
                <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'height'</span>) === <span class="hljs-string">'auto'</span>) {
                    <span class="hljs-keyword">if</span> (!options.get(<span class="hljs-string">'composite'</span>) || !$.data(<span class="hljs-keyword">this</span>, <span class="hljs-string">'_jqs_vcanvas'</span>)) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28"></a>
</div>
<p>must be a better way to get the line height</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                        tmp = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'span'</span>);
                        tmp.innerHTML = <span class="hljs-string">'a'</span>;
                        $<span class="hljs-keyword">this</span>.html(tmp);
                        height = $(tmp).innerHeight() || $(tmp).height();
                        $(tmp).remove();
                        tmp = <span class="hljs-literal">null</span>;
                    }
                } <span class="hljs-keyword">else</span> {
                    height = options.get(<span class="hljs-string">'height'</span>);
                }

                <span class="hljs-keyword">if</span> (!options.get(<span class="hljs-string">'disableInteraction'</span>)) {
                    mhandler = $.data(<span class="hljs-keyword">this</span>, <span class="hljs-string">'_jqs_mhandler'</span>);
                    <span class="hljs-keyword">if</span> (!mhandler) {
                        mhandler = <span class="hljs-keyword">new</span> MouseHandler(<span class="hljs-keyword">this</span>, options);
                        $.data(<span class="hljs-keyword">this</span>, <span class="hljs-string">'_jqs_mhandler'</span>, mhandler);
                    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!options.get(<span class="hljs-string">'composite'</span>)) {
                        mhandler.reset();
                    }
                } <span class="hljs-keyword">else</span> {
                    mhandler = <span class="hljs-literal">false</span>;
                }

                <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'composite'</span>) &amp;&amp; !$.data(<span class="hljs-keyword">this</span>, <span class="hljs-string">'_jqs_vcanvas'</span>)) {
                    <span class="hljs-keyword">if</span> (!$.data(<span class="hljs-keyword">this</span>, <span class="hljs-string">'_jqs_errnotify'</span>)) {
                        alert(<span class="hljs-string">'Attempted to attach a composite sparkline to an element with no existing sparkline'</span>);
                        $.data(<span class="hljs-keyword">this</span>, <span class="hljs-string">'_jqs_errnotify'</span>, <span class="hljs-literal">true</span>);
                    }
                    <span class="hljs-keyword">return</span>;
                }

                sp = <span class="hljs-keyword">new</span> $.fn.sparkline[options.get(<span class="hljs-string">'type'</span>)](<span class="hljs-keyword">this</span>, values, options, width, height);

                sp.render();

                <span class="hljs-keyword">if</span> (mhandler) {
                    mhandler.registerSparkline(sp);
                }
            };
            <span class="hljs-keyword">if</span> (($(<span class="hljs-keyword">this</span>).html() &amp;&amp; !options.get(<span class="hljs-string">'disableHiddenCheck'</span>) &amp;&amp; $(<span class="hljs-keyword">this</span>).is(<span class="hljs-string">':hidden'</span>)) || !$(<span class="hljs-keyword">this</span>).parents(<span class="hljs-string">'body'</span>).length) {
                <span class="hljs-keyword">if</span> (!options.get(<span class="hljs-string">'composite'</span>) &amp;&amp; $.data(<span class="hljs-keyword">this</span>, <span class="hljs-string">'_jqs_pending'</span>)) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29"></a>
</div>
<p>remove any existing references to the element</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                    <span class="hljs-keyword">for</span> (i = pending.length; i; i--) {
                        <span class="hljs-keyword">if</span> (pending[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] == <span class="hljs-keyword">this</span>) {
                            pending.splice(i - <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);
                        }
                    }
                }
                pending.push([<span class="hljs-keyword">this</span>, render]);
                $.data(<span class="hljs-keyword">this</span>, <span class="hljs-string">'_jqs_pending'</span>, <span class="hljs-literal">true</span>);
            } <span class="hljs-keyword">else</span> {
                render.call(<span class="hljs-keyword">this</span>);
            }
        });
    };

    $.fn.sparkline.defaults = getDefaults();


    $.sparkline_display_visible = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> el, i, pl;
        <span class="hljs-keyword">var</span> done = [];
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, pl = pending.length; i &lt; pl; i++) {
            el = pending[i][<span class="hljs-number">0</span>];
            <span class="hljs-keyword">if</span> ($(el).is(<span class="hljs-string">':visible'</span>) &amp;&amp; !$(el).parents().is(<span class="hljs-string">':hidden'</span>)) {
                pending[i][<span class="hljs-number">1</span>].call(el);
                $.data(pending[i][<span class="hljs-number">0</span>], <span class="hljs-string">'_jqs_pending'</span>, <span class="hljs-literal">false</span>);
                done.push(i);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!$(el).closest(<span class="hljs-string">'html'</span>).length &amp;&amp; !$.data(el, <span class="hljs-string">'_jqs_pending'</span>)) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30"></a>
</div>
<p>element has been inserted and removed from the DOM
If it was not yet inserted into the dom then the .data request
will return true.
removing from the dom causes the data to be removed.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                $.data(pending[i][<span class="hljs-number">0</span>], <span class="hljs-string">'_jqs_pending'</span>, <span class="hljs-literal">false</span>);
                done.push(i);
            }
        }
        <span class="hljs-keyword">for</span> (i = done.length; i; i--) {
            pending.splice(done[i - <span class="hljs-number">1</span>], <span class="hljs-number">1</span>);
        }
    };


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-31" id="section-31"></a>
</div>
<div class="dox">
<div class="summary">
<p>User option handler</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">    $.fn.sparkline.options = createClass({
        <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">tag, userOptions</span>) </span>{
            <span class="hljs-keyword">var</span> extendedOptions, defaults, base, tagOptionType;
            <span class="hljs-keyword">this</span>.userOptions = userOptions = userOptions || {};
            <span class="hljs-keyword">this</span>.tag = tag;
            <span class="hljs-keyword">this</span>.tagValCache = {};
            defaults = $.fn.sparkline.defaults;
            base = defaults.common;
            <span class="hljs-keyword">this</span>.tagOptionsPrefix = userOptions.enableTagOptions &amp;&amp; (userOptions.tagOptionsPrefix || base.tagOptionsPrefix);

            tagOptionType = <span class="hljs-keyword">this</span>.getTagSetting(<span class="hljs-string">'type'</span>);
            <span class="hljs-keyword">if</span> (tagOptionType === UNSET_OPTION) {
                extendedOptions = defaults[userOptions.type || base.type];
            } <span class="hljs-keyword">else</span> {
                extendedOptions = defaults[tagOptionType];
            }
            <span class="hljs-keyword">this</span>.mergedOptions = $.extend({}, base, extendedOptions, userOptions);
        },


        <span class="hljs-attr">getTagSetting</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key</span>) </span>{
            <span class="hljs-keyword">var</span> prefix = <span class="hljs-keyword">this</span>.tagOptionsPrefix,
                val, i, pairs, keyval;
            <span class="hljs-keyword">if</span> (prefix === <span class="hljs-literal">false</span> || prefix === <span class="hljs-literal">undefined</span>) {
                <span class="hljs-keyword">return</span> UNSET_OPTION;
            }
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tagValCache.hasOwnProperty(key)) {
                val = <span class="hljs-keyword">this</span>.tagValCache.key;
            } <span class="hljs-keyword">else</span> {
                val = <span class="hljs-keyword">this</span>.tag.getAttribute(prefix + key);
                <span class="hljs-keyword">if</span> (val === <span class="hljs-literal">undefined</span> || val === <span class="hljs-literal">null</span>) {
                    val = UNSET_OPTION;
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (val.substr(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) === <span class="hljs-string">'['</span>) {
                    val = val.substr(<span class="hljs-number">1</span>, val.length - <span class="hljs-number">2</span>).split(<span class="hljs-string">','</span>);
                    <span class="hljs-keyword">for</span> (i = val.length; i--;) {
                        val[i] = normalizeValue(val[i].replace(<span class="hljs-regexp">/(^\s*)|(\s*$)/g</span>, <span class="hljs-string">''</span>));
                    }
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (val.substr(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) === <span class="hljs-string">'{'</span>) {
                    pairs = val.substr(<span class="hljs-number">1</span>, val.length - <span class="hljs-number">2</span>).split(<span class="hljs-string">','</span>);
                    val = {};
                    <span class="hljs-keyword">for</span> (i = pairs.length; i--;) {
                        keyval = pairs[i].split(<span class="hljs-string">':'</span>, <span class="hljs-number">2</span>);
                        val[keyval[<span class="hljs-number">0</span>].replace(<span class="hljs-regexp">/(^\s*)|(\s*$)/g</span>, <span class="hljs-string">''</span>)] = normalizeValue(keyval[<span class="hljs-number">1</span>].replace(<span class="hljs-regexp">/(^\s*)|(\s*$)/g</span>, <span class="hljs-string">''</span>));
                    }
                } <span class="hljs-keyword">else</span> {
                    val = normalizeValue(val);
                }
                <span class="hljs-keyword">this</span>.tagValCache.key = val;
            }
            <span class="hljs-keyword">return</span> val;
        },

        <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key, defaultval</span>) </span>{
            <span class="hljs-keyword">var</span> tagOption = <span class="hljs-keyword">this</span>.getTagSetting(key),
                result;
            <span class="hljs-keyword">if</span> (tagOption !== UNSET_OPTION) {
                <span class="hljs-keyword">return</span> tagOption;
            }
            <span class="hljs-keyword">return</span> (result = <span class="hljs-keyword">this</span>.mergedOptions[key]) === <span class="hljs-literal">undefined</span> ? defaultval : result;
        }
    });


    $.fn.sparkline._base = createClass({
        <span class="hljs-attr">disabled</span>: <span class="hljs-literal">false</span>,

        <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el, values, options, width, height</span>) </span>{
            <span class="hljs-keyword">this</span>.el = el;
            <span class="hljs-keyword">this</span>.$el = $(el);
            <span class="hljs-keyword">this</span>.values = values;
            <span class="hljs-keyword">this</span>.options = options;
            <span class="hljs-keyword">this</span>.width = width;
            <span class="hljs-keyword">this</span>.height = height;
            <span class="hljs-keyword">this</span>.currentRegion = <span class="hljs-literal">undefined</span>;
        },

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-32" id="section-32"></a>
</div>
<div class="dox">
<div class="summary">
<p>Setup the canvas</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">        initTarget: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> interactive = !<span class="hljs-keyword">this</span>.options.get(<span class="hljs-string">'disableInteraction'</span>);
            <span class="hljs-keyword">if</span> (!(<span class="hljs-keyword">this</span>.target = <span class="hljs-keyword">this</span>.$el.simpledraw(<span class="hljs-keyword">this</span>.width, <span class="hljs-keyword">this</span>.height, <span class="hljs-keyword">this</span>.options.get(<span class="hljs-string">'composite'</span>), interactive))) {
                <span class="hljs-keyword">this</span>.disabled = <span class="hljs-literal">true</span>;
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">this</span>.canvasWidth = <span class="hljs-keyword">this</span>.target.pixelWidth;
                <span class="hljs-keyword">this</span>.canvasHeight = <span class="hljs-keyword">this</span>.target.pixelHeight;
            }
        },

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-33" id="section-33"></a>
</div>
<div class="dox">
<div class="summary">
<p>Actually render the chart to the canvas</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">        render: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.disabled) {
                <span class="hljs-keyword">this</span>.el.innerHTML = <span class="hljs-string">''</span>;
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        },

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-34" id="section-34"></a>
</div>
<div class="dox">
<div class="summary">
<p>Return a region id for a given x/y co-ordinate</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">        getRegion: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">x, y</span>) </span>{
        },

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-35" id="section-35"></a>
</div>
<div class="dox">
<div class="summary">
<p>Highlight an item based on the moused-over x,y co-ordinate</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">        setRegionHighlight: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el, x, y</span>) </span>{
            <span class="hljs-keyword">var</span> currentRegion = <span class="hljs-keyword">this</span>.currentRegion,
                highlightEnabled = !<span class="hljs-keyword">this</span>.options.get(<span class="hljs-string">'disableHighlight'</span>),
                newRegion;
            <span class="hljs-keyword">if</span> (x &gt; <span class="hljs-keyword">this</span>.canvasWidth || y &gt; <span class="hljs-keyword">this</span>.canvasHeight || x &lt; <span class="hljs-number">0</span> || y &lt; <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
            }
            newRegion = <span class="hljs-keyword">this</span>.getRegion(el, x, y);
            <span class="hljs-keyword">if</span> (currentRegion !== newRegion) {
                <span class="hljs-keyword">if</span> (currentRegion !== <span class="hljs-literal">undefined</span> &amp;&amp; highlightEnabled) {
                    <span class="hljs-keyword">this</span>.removeHighlight();
                }
                <span class="hljs-keyword">this</span>.currentRegion = newRegion;
                <span class="hljs-keyword">if</span> (newRegion !== <span class="hljs-literal">undefined</span> &amp;&amp; highlightEnabled) {
                    <span class="hljs-keyword">this</span>.renderHighlight();
                }
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        },

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-36" id="section-36"></a>
</div>
<div class="dox">
<div class="summary">
<p>Reset any currently highlighted item</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">        clearRegionHighlight: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.currentRegion !== <span class="hljs-literal">undefined</span>) {
                <span class="hljs-keyword">this</span>.removeHighlight();
                <span class="hljs-keyword">this</span>.currentRegion = <span class="hljs-literal">undefined</span>;
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        },

        <span class="hljs-attr">renderHighlight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">this</span>.changeHighlight(<span class="hljs-literal">true</span>);
        },

        <span class="hljs-attr">removeHighlight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">this</span>.changeHighlight(<span class="hljs-literal">false</span>);
        },

        <span class="hljs-attr">changeHighlight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">highlight</span>)  </span>{},

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-37" id="section-37"></a>
</div>
<div class="dox">
<div class="summary">
<p>Fetch the HTML to display as a tooltip</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">        getCurrentRegionTooltip: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> options = <span class="hljs-keyword">this</span>.options,
                header = <span class="hljs-string">''</span>,
                entries = [],
                fields, formats, formatlen, fclass, text, i,
                showFields, showFieldsKey, newFields, fv,
                formatter, format, fieldlen, j;
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.currentRegion === <span class="hljs-literal">undefined</span>) {
                <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
            }
            fields = <span class="hljs-keyword">this</span>.getCurrentRegionFields();
            formatter = options.get(<span class="hljs-string">'tooltipFormatter'</span>);
            <span class="hljs-keyword">if</span> (formatter) {
                <span class="hljs-keyword">return</span> formatter(<span class="hljs-keyword">this</span>, options, fields);
            }
            <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'tooltipChartTitle'</span>)) {
                header += <span class="hljs-string">'&lt;div class="jqs jqstitle"&gt;'</span> + options.get(<span class="hljs-string">'tooltipChartTitle'</span>) + <span class="hljs-string">'&lt;/div&gt;\n'</span>;
            }
            formats = <span class="hljs-keyword">this</span>.options.get(<span class="hljs-string">'tooltipFormat'</span>);
            <span class="hljs-keyword">if</span> (!formats) {
                <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
            }
            <span class="hljs-keyword">if</span> (!$.isArray(formats)) {
                formats = [formats];
            }
            <span class="hljs-keyword">if</span> (!$.isArray(fields)) {
                fields = [fields];
            }
            showFields = <span class="hljs-keyword">this</span>.options.get(<span class="hljs-string">'tooltipFormatFieldlist'</span>);
            showFieldsKey = <span class="hljs-keyword">this</span>.options.get(<span class="hljs-string">'tooltipFormatFieldlistKey'</span>);
            <span class="hljs-keyword">if</span> (showFields &amp;&amp; showFieldsKey) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-38" id="section-38"></a>
</div>
<p>user-selected ordering of fields</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                newFields = [];
                <span class="hljs-keyword">for</span> (i = fields.length; i--;) {
                    fv = fields[i][showFieldsKey];
                    <span class="hljs-keyword">if</span> ((j = $.inArray(fv, showFields)) != <span class="hljs-number">-1</span>) {
                        newFields[j] = fields[i];
                    }
                }
                fields = newFields;
            }
            formatlen = formats.length;
            fieldlen = fields.length;
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; formatlen; i++) {
                format = formats[i];
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> format === <span class="hljs-string">'string'</span>) {
                    format = <span class="hljs-keyword">new</span> SPFormat(format);
                }
                fclass = format.fclass || <span class="hljs-string">'jqsfield'</span>;
                <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; fieldlen; j++) {
                    <span class="hljs-keyword">if</span> (!fields[j].isNull || !options.get(<span class="hljs-string">'tooltipSkipNull'</span>)) {
                        $.extend(fields[j], {
                            <span class="hljs-attr">prefix</span>: options.get(<span class="hljs-string">'tooltipPrefix'</span>),
                            <span class="hljs-attr">suffix</span>: options.get(<span class="hljs-string">'tooltipSuffix'</span>)
                        });
                        text = format.render(fields[j], options.get(<span class="hljs-string">'tooltipValueLookups'</span>), options);
                        entries.push(<span class="hljs-string">'&lt;div class="'</span> + fclass + <span class="hljs-string">'"&gt;'</span> + text + <span class="hljs-string">'&lt;/div&gt;'</span>);
                    }
                }
            }
            <span class="hljs-keyword">if</span> (entries.length) {
                <span class="hljs-keyword">return</span> header + entries.join(<span class="hljs-string">'\n'</span>);
            }
            <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
        },

        <span class="hljs-attr">getCurrentRegionFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{},

        <span class="hljs-attr">calcHighlightColor</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">color, options</span>) </span>{
            <span class="hljs-keyword">var</span> highlightColor = options.get(<span class="hljs-string">'highlightColor'</span>),
                lighten = options.get(<span class="hljs-string">'highlightLighten'</span>),
                parse, mult, rgbnew, i;
            <span class="hljs-keyword">if</span> (highlightColor) {
                <span class="hljs-keyword">return</span> highlightColor;
            }
            <span class="hljs-keyword">if</span> (lighten) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-39" id="section-39"></a>
</div>
<p>extract RGB values</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                parse = <span class="hljs-regexp">/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i</span>.exec(color) || <span class="hljs-regexp">/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i</span>.exec(color);
                <span class="hljs-keyword">if</span> (parse) {
                    rgbnew = [];
                    mult = color.length === <span class="hljs-number">4</span> ? <span class="hljs-number">16</span> : <span class="hljs-number">1</span>;
                    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
                        rgbnew[i] = clipval(<span class="hljs-built_in">Math</span>.round(<span class="hljs-built_in">parseInt</span>(parse[i + <span class="hljs-number">1</span>], <span class="hljs-number">16</span>) * mult * lighten), <span class="hljs-number">0</span>, <span class="hljs-number">255</span>);
                    }
                    <span class="hljs-keyword">return</span> <span class="hljs-string">'rgb('</span> + rgbnew.join(<span class="hljs-string">','</span>) + <span class="hljs-string">')'</span>;
                }

            }
            <span class="hljs-keyword">return</span> color;
        }

    });

    barHighlightMixin = {
        <span class="hljs-attr">changeHighlight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">highlight</span>) </span>{
            <span class="hljs-keyword">var</span> currentRegion = <span class="hljs-keyword">this</span>.currentRegion,
                target = <span class="hljs-keyword">this</span>.target,
                shapeids = <span class="hljs-keyword">this</span>.regionShapes[currentRegion],
                newShapes;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-40" id="section-40"></a>
</div>
<p>will be null if the region value was null</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">if</span> (shapeids) {
                newShapes = <span class="hljs-keyword">this</span>.renderRegion(currentRegion, highlight);
                <span class="hljs-keyword">if</span> ($.isArray(newShapes) || $.isArray(shapeids)) {
                    target.replaceWithShapes(shapeids, newShapes);
                    <span class="hljs-keyword">this</span>.regionShapes[currentRegion] = $.map(newShapes, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">newShape</span>) </span>{
                        <span class="hljs-keyword">return</span> newShape.id;
                    });
                } <span class="hljs-keyword">else</span> {
                    target.replaceWithShape(shapeids, newShapes);
                    <span class="hljs-keyword">this</span>.regionShapes[currentRegion] = newShapes.id;
                }
            }
        },

        <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> values = <span class="hljs-keyword">this</span>.values,
                target = <span class="hljs-keyword">this</span>.target,
                regionShapes = <span class="hljs-keyword">this</span>.regionShapes,
                shapes, ids, i, j;

            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.cls._super.render.call(<span class="hljs-keyword">this</span>)) {
                <span class="hljs-keyword">return</span>;
            }
            <span class="hljs-keyword">for</span> (i = values.length; i--;) {
                shapes = <span class="hljs-keyword">this</span>.renderRegion(i);
                <span class="hljs-keyword">if</span> (shapes) {
                    <span class="hljs-keyword">if</span> ($.isArray(shapes)) {
                        ids = [];
                        <span class="hljs-keyword">for</span> (j = shapes.length; j--;) {
                            shapes[j].append();
                            ids.push(shapes[j].id);
                        }
                        regionShapes[i] = ids;
                    } <span class="hljs-keyword">else</span> {
                        shapes.append();
                        regionShapes[i] = shapes.id; <span class="hljs-comment">// store just the shapeid</span>
                    }
                } <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-41" id="section-41"></a>
</div>
<p>null value</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                    regionShapes[i] = <span class="hljs-literal">null</span>;
                }
            }
            target.render();
        }
    };

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-42" id="section-42"></a>
</div>
<div class="dox">
<div class="summary">
<p>Line charts</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">    $.fn.sparkline.line = line = createClass($.fn.sparkline._base, {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'line'</span>,

        <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el, values, options, width, height</span>) </span>{
            line._super.init.call(<span class="hljs-keyword">this</span>, el, values, options, width, height);
            <span class="hljs-keyword">this</span>.vertices = [];
            <span class="hljs-keyword">this</span>.regionMap = [];
            <span class="hljs-keyword">this</span>.xvalues = [];
            <span class="hljs-keyword">this</span>.yvalues = [];
            <span class="hljs-keyword">this</span>.yminmax = [];
            <span class="hljs-keyword">this</span>.hightlightSpotId = <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">this</span>.lastShapeId = <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">this</span>.initTarget();
        },

        <span class="hljs-attr">getRegion</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el, x, y</span>) </span>{
            <span class="hljs-keyword">var</span> i,
                regionMap = <span class="hljs-keyword">this</span>.regionMap; <span class="hljs-comment">// maps regions to value positions</span>
            <span class="hljs-keyword">for</span> (i = regionMap.length; i--;) {
                <span class="hljs-keyword">if</span> (regionMap[i] !== <span class="hljs-literal">null</span> &amp;&amp; x &gt;= regionMap[i][<span class="hljs-number">0</span>] &amp;&amp; x &lt;= regionMap[i][<span class="hljs-number">1</span>]) {
                    <span class="hljs-keyword">return</span> regionMap[i][<span class="hljs-number">2</span>];
                }
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;
        },

        <span class="hljs-attr">getCurrentRegionFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> currentRegion = <span class="hljs-keyword">this</span>.currentRegion;
            <span class="hljs-keyword">return</span> {
                <span class="hljs-attr">isNull</span>: <span class="hljs-keyword">this</span>.yvalues[currentRegion] === <span class="hljs-literal">null</span>,
                <span class="hljs-attr">x</span>: <span class="hljs-keyword">this</span>.xvalues[currentRegion],
                <span class="hljs-attr">y</span>: <span class="hljs-keyword">this</span>.yvalues[currentRegion],
                <span class="hljs-attr">color</span>: <span class="hljs-keyword">this</span>.options.get(<span class="hljs-string">'lineColor'</span>),
                <span class="hljs-attr">fillColor</span>: <span class="hljs-keyword">this</span>.options.get(<span class="hljs-string">'fillColor'</span>),
                <span class="hljs-attr">offset</span>: currentRegion
            };
        },

        <span class="hljs-attr">renderHighlight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> currentRegion = <span class="hljs-keyword">this</span>.currentRegion,
                target = <span class="hljs-keyword">this</span>.target,
                vertex = <span class="hljs-keyword">this</span>.vertices[currentRegion],
                options = <span class="hljs-keyword">this</span>.options,
                spotRadius = options.get(<span class="hljs-string">'spotRadius'</span>),
                highlightSpotColor = options.get(<span class="hljs-string">'highlightSpotColor'</span>),
                highlightLineColor = options.get(<span class="hljs-string">'highlightLineColor'</span>),
                highlightSpot, highlightLine;

            <span class="hljs-keyword">if</span> (!vertex) {
                <span class="hljs-keyword">return</span>;
            }
            <span class="hljs-keyword">if</span> (spotRadius &amp;&amp; highlightSpotColor) {
                highlightSpot = target.drawCircle(vertex[<span class="hljs-number">0</span>], vertex[<span class="hljs-number">1</span>],
                    spotRadius, <span class="hljs-literal">undefined</span>, highlightSpotColor);
                <span class="hljs-keyword">this</span>.highlightSpotId = highlightSpot.id;
                target.insertAfterShape(<span class="hljs-keyword">this</span>.lastShapeId, highlightSpot);
            }
            <span class="hljs-keyword">if</span> (highlightLineColor) {
                highlightLine = target.drawLine(vertex[<span class="hljs-number">0</span>], <span class="hljs-keyword">this</span>.canvasTop, vertex[<span class="hljs-number">0</span>],
                    <span class="hljs-keyword">this</span>.canvasTop + <span class="hljs-keyword">this</span>.canvasHeight, highlightLineColor);
                <span class="hljs-keyword">this</span>.highlightLineId = highlightLine.id;
                target.insertAfterShape(<span class="hljs-keyword">this</span>.lastShapeId, highlightLine);
            }
        },

        <span class="hljs-attr">removeHighlight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> target = <span class="hljs-keyword">this</span>.target;
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.highlightSpotId) {
                target.removeShapeId(<span class="hljs-keyword">this</span>.highlightSpotId);
                <span class="hljs-keyword">this</span>.highlightSpotId = <span class="hljs-literal">null</span>;
            }
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.highlightLineId) {
                target.removeShapeId(<span class="hljs-keyword">this</span>.highlightLineId);
                <span class="hljs-keyword">this</span>.highlightLineId = <span class="hljs-literal">null</span>;
            }
        },

        <span class="hljs-attr">scanValues</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> values = <span class="hljs-keyword">this</span>.values,
                valcount = values.length,
                xvalues = <span class="hljs-keyword">this</span>.xvalues,
                yvalues = <span class="hljs-keyword">this</span>.yvalues,
                yminmax = <span class="hljs-keyword">this</span>.yminmax,
                i, val, isStr, isArray, sp;
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; valcount; i++) {
                val = values[i];
                isStr = <span class="hljs-keyword">typeof</span>(values[i]) === <span class="hljs-string">'string'</span>;
                isArray = <span class="hljs-keyword">typeof</span>(values[i]) === <span class="hljs-string">'object'</span> &amp;&amp; values[i] <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Array</span>;
                sp = isStr &amp;&amp; values[i].split(<span class="hljs-string">':'</span>);
                <span class="hljs-keyword">if</span> (isStr &amp;&amp; sp.length === <span class="hljs-number">2</span>) { <span class="hljs-comment">// x:y</span>
                    xvalues.push(<span class="hljs-built_in">Number</span>(sp[<span class="hljs-number">0</span>]));
                    yvalues.push(<span class="hljs-built_in">Number</span>(sp[<span class="hljs-number">1</span>]));
                    yminmax.push(<span class="hljs-built_in">Number</span>(sp[<span class="hljs-number">1</span>]));
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isArray) {
                    xvalues.push(val[<span class="hljs-number">0</span>]);
                    yvalues.push(val[<span class="hljs-number">1</span>]);
                    yminmax.push(val[<span class="hljs-number">1</span>]);
                } <span class="hljs-keyword">else</span> {
                    xvalues.push(i);
                    <span class="hljs-keyword">if</span> (values[i] === <span class="hljs-literal">null</span> || values[i] === <span class="hljs-string">'null'</span>) {
                        yvalues.push(<span class="hljs-literal">null</span>);
                    } <span class="hljs-keyword">else</span> {
                        yvalues.push(<span class="hljs-built_in">Number</span>(val));
                        yminmax.push(<span class="hljs-built_in">Number</span>(val));
                    }
                }
            }
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.get(<span class="hljs-string">'xvalues'</span>)) {
                xvalues = <span class="hljs-keyword">this</span>.options.get(<span class="hljs-string">'xvalues'</span>);
            }

            <span class="hljs-keyword">this</span>.maxy = <span class="hljs-keyword">this</span>.maxyorg = <span class="hljs-built_in">Math</span>.max.apply(<span class="hljs-built_in">Math</span>, yminmax);
            <span class="hljs-keyword">this</span>.miny = <span class="hljs-keyword">this</span>.minyorg = <span class="hljs-built_in">Math</span>.min.apply(<span class="hljs-built_in">Math</span>, yminmax);

            <span class="hljs-keyword">this</span>.maxx = <span class="hljs-built_in">Math</span>.max.apply(<span class="hljs-built_in">Math</span>, xvalues);
            <span class="hljs-keyword">this</span>.minx = <span class="hljs-built_in">Math</span>.min.apply(<span class="hljs-built_in">Math</span>, xvalues);

            <span class="hljs-keyword">this</span>.xvalues = xvalues;
            <span class="hljs-keyword">this</span>.yvalues = yvalues;
            <span class="hljs-keyword">this</span>.yminmax = yminmax;

        },

        <span class="hljs-attr">processRangeOptions</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> options = <span class="hljs-keyword">this</span>.options,
                normalRangeMin = options.get(<span class="hljs-string">'normalRangeMin'</span>),
                normalRangeMax = options.get(<span class="hljs-string">'normalRangeMax'</span>);

            <span class="hljs-keyword">if</span> (normalRangeMin !== <span class="hljs-literal">undefined</span>) {
                <span class="hljs-keyword">if</span> (normalRangeMin &lt; <span class="hljs-keyword">this</span>.miny) {
                    <span class="hljs-keyword">this</span>.miny = normalRangeMin;
                }
                <span class="hljs-keyword">if</span> (normalRangeMax &gt; <span class="hljs-keyword">this</span>.maxy) {
                    <span class="hljs-keyword">this</span>.maxy = normalRangeMax;
                }
            }
            <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'chartRangeMin'</span>) !== <span class="hljs-literal">undefined</span> &amp;&amp; (options.get(<span class="hljs-string">'chartRangeClip'</span>) || options.get(<span class="hljs-string">'chartRangeMin'</span>) &lt; <span class="hljs-keyword">this</span>.miny)) {
                <span class="hljs-keyword">this</span>.miny = options.get(<span class="hljs-string">'chartRangeMin'</span>);
            }
            <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'chartRangeMax'</span>) !== <span class="hljs-literal">undefined</span> &amp;&amp; (options.get(<span class="hljs-string">'chartRangeClip'</span>) || options.get(<span class="hljs-string">'chartRangeMax'</span>) &gt; <span class="hljs-keyword">this</span>.maxy)) {
                <span class="hljs-keyword">this</span>.maxy = options.get(<span class="hljs-string">'chartRangeMax'</span>);
            }
            <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'chartRangeMinX'</span>) !== <span class="hljs-literal">undefined</span> &amp;&amp; (options.get(<span class="hljs-string">'chartRangeClipX'</span>) || options.get(<span class="hljs-string">'chartRangeMinX'</span>) &lt; <span class="hljs-keyword">this</span>.minx)) {
                <span class="hljs-keyword">this</span>.minx = options.get(<span class="hljs-string">'chartRangeMinX'</span>);
            }
            <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'chartRangeMaxX'</span>) !== <span class="hljs-literal">undefined</span> &amp;&amp; (options.get(<span class="hljs-string">'chartRangeClipX'</span>) || options.get(<span class="hljs-string">'chartRangeMaxX'</span>) &gt; <span class="hljs-keyword">this</span>.maxx)) {
                <span class="hljs-keyword">this</span>.maxx = options.get(<span class="hljs-string">'chartRangeMaxX'</span>);
            }

        },

        <span class="hljs-attr">drawNormalRange</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">canvasLeft, canvasTop, canvasHeight, canvasWidth, rangey</span>) </span>{
            <span class="hljs-keyword">var</span> normalRangeMin = <span class="hljs-keyword">this</span>.options.get(<span class="hljs-string">'normalRangeMin'</span>),
                normalRangeMax = <span class="hljs-keyword">this</span>.options.get(<span class="hljs-string">'normalRangeMax'</span>),
                ytop = canvasTop + <span class="hljs-built_in">Math</span>.round(canvasHeight - (canvasHeight * ((normalRangeMax - <span class="hljs-keyword">this</span>.miny) / rangey))),
                height = <span class="hljs-built_in">Math</span>.round((canvasHeight * (normalRangeMax - normalRangeMin)) / rangey);
            <span class="hljs-keyword">this</span>.target.drawRect(canvasLeft, ytop, canvasWidth, height, <span class="hljs-literal">undefined</span>, <span class="hljs-keyword">this</span>.options.get(<span class="hljs-string">'normalRangeColor'</span>)).append();
        },

        <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> options = <span class="hljs-keyword">this</span>.options,
                target = <span class="hljs-keyword">this</span>.target,
                canvasWidth = <span class="hljs-keyword">this</span>.canvasWidth,
                canvasHeight = <span class="hljs-keyword">this</span>.canvasHeight,
                vertices = <span class="hljs-keyword">this</span>.vertices,
                spotRadius = options.get(<span class="hljs-string">'spotRadius'</span>),
                regionMap = <span class="hljs-keyword">this</span>.regionMap,
                rangex, rangey, yvallast,
                canvasTop, canvasLeft,
                vertex, path, paths, x, y, xnext, xpos, xposnext,
                last, next, yvalcount, lineShapes, fillShapes, plen,
                valueSpots, hlSpotsEnabled, color, xvalues, yvalues, i;

            <span class="hljs-keyword">if</span> (!line._super.render.call(<span class="hljs-keyword">this</span>)) {
                <span class="hljs-keyword">return</span>;
            }

            <span class="hljs-keyword">this</span>.scanValues();
            <span class="hljs-keyword">this</span>.processRangeOptions();

            xvalues = <span class="hljs-keyword">this</span>.xvalues;
            yvalues = <span class="hljs-keyword">this</span>.yvalues;

            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.yminmax.length || <span class="hljs-keyword">this</span>.yvalues.length &lt; <span class="hljs-number">2</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-43" id="section-43"></a>
</div>
<p>empty or all null valuess</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                <span class="hljs-keyword">return</span>;
            }

            canvasTop = canvasLeft = <span class="hljs-number">0</span>;

            rangex = <span class="hljs-keyword">this</span>.maxx - <span class="hljs-keyword">this</span>.minx === <span class="hljs-number">0</span> ? <span class="hljs-number">1</span> : <span class="hljs-keyword">this</span>.maxx - <span class="hljs-keyword">this</span>.minx;
            rangey = <span class="hljs-keyword">this</span>.maxy - <span class="hljs-keyword">this</span>.miny === <span class="hljs-number">0</span> ? <span class="hljs-number">1</span> : <span class="hljs-keyword">this</span>.maxy - <span class="hljs-keyword">this</span>.miny;
            yvallast = <span class="hljs-keyword">this</span>.yvalues.length - <span class="hljs-number">1</span>;

            <span class="hljs-keyword">if</span> (spotRadius &amp;&amp; (canvasWidth &lt; (spotRadius * <span class="hljs-number">4</span>) || canvasHeight &lt; (spotRadius * <span class="hljs-number">4</span>))) {
                spotRadius = <span class="hljs-number">0</span>;
            }
            <span class="hljs-keyword">if</span> (spotRadius) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-44" id="section-44"></a>
</div>
<p>adjust the canvas size as required so that spots will fit</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                hlSpotsEnabled = options.get(<span class="hljs-string">'highlightSpotColor'</span>) &amp;&amp;  !options.get(<span class="hljs-string">'disableInteraction'</span>);
                <span class="hljs-keyword">if</span> (hlSpotsEnabled || options.get(<span class="hljs-string">'minSpotColor'</span>) || (options.get(<span class="hljs-string">'spotColor'</span>) &amp;&amp; yvalues[yvallast] === <span class="hljs-keyword">this</span>.miny)) {
                    canvasHeight -= <span class="hljs-built_in">Math</span>.ceil(spotRadius);
                }
                <span class="hljs-keyword">if</span> (hlSpotsEnabled || options.get(<span class="hljs-string">'maxSpotColor'</span>) || (options.get(<span class="hljs-string">'spotColor'</span>) &amp;&amp; yvalues[yvallast] === <span class="hljs-keyword">this</span>.maxy)) {
                    canvasHeight -= <span class="hljs-built_in">Math</span>.ceil(spotRadius);
                    canvasTop += <span class="hljs-built_in">Math</span>.ceil(spotRadius);
                }
                <span class="hljs-keyword">if</span> (hlSpotsEnabled ||
                     ((options.get(<span class="hljs-string">'minSpotColor'</span>) || options.get(<span class="hljs-string">'maxSpotColor'</span>)) &amp;&amp; (yvalues[<span class="hljs-number">0</span>] === <span class="hljs-keyword">this</span>.miny || yvalues[<span class="hljs-number">0</span>] === <span class="hljs-keyword">this</span>.maxy))) {
                    canvasLeft += <span class="hljs-built_in">Math</span>.ceil(spotRadius);
                    canvasWidth -= <span class="hljs-built_in">Math</span>.ceil(spotRadius);
                }
                <span class="hljs-keyword">if</span> (hlSpotsEnabled || options.get(<span class="hljs-string">'spotColor'</span>) ||
                    (options.get(<span class="hljs-string">'minSpotColor'</span>) || options.get(<span class="hljs-string">'maxSpotColor'</span>) &amp;&amp;
                        (yvalues[yvallast] === <span class="hljs-keyword">this</span>.miny || yvalues[yvallast] === <span class="hljs-keyword">this</span>.maxy))) {
                    canvasWidth -= <span class="hljs-built_in">Math</span>.ceil(spotRadius);
                }
            }


            canvasHeight--;

            <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'normalRangeMin'</span>) !== <span class="hljs-literal">undefined</span> &amp;&amp; !options.get(<span class="hljs-string">'drawNormalOnTop'</span>)) {
                <span class="hljs-keyword">this</span>.drawNormalRange(canvasLeft, canvasTop, canvasHeight, canvasWidth, rangey);
            }

            path = [];
            paths = [path];
            last = next = <span class="hljs-literal">null</span>;
            yvalcount = yvalues.length;
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; yvalcount; i++) {
                x = xvalues[i];
                xnext = xvalues[i + <span class="hljs-number">1</span>];
                y = yvalues[i];
                xpos = canvasLeft + <span class="hljs-built_in">Math</span>.round((x - <span class="hljs-keyword">this</span>.minx) * (canvasWidth / rangex));
                xposnext = i &lt; yvalcount - <span class="hljs-number">1</span> ? canvasLeft + <span class="hljs-built_in">Math</span>.round((xnext - <span class="hljs-keyword">this</span>.minx) * (canvasWidth / rangex)) : canvasWidth;
                next = xpos + ((xposnext - xpos) / <span class="hljs-number">2</span>);
                regionMap[i] = [last || <span class="hljs-number">0</span>, next, i];
                last = next;
                <span class="hljs-keyword">if</span> (y === <span class="hljs-literal">null</span>) {
                    <span class="hljs-keyword">if</span> (i) {
                        <span class="hljs-keyword">if</span> (yvalues[i - <span class="hljs-number">1</span>] !== <span class="hljs-literal">null</span>) {
                            path = [];
                            paths.push(path);
                        }
                        vertices.push(<span class="hljs-literal">null</span>);
                    }
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">if</span> (y &lt; <span class="hljs-keyword">this</span>.miny) {
                        y = <span class="hljs-keyword">this</span>.miny;
                    }
                    <span class="hljs-keyword">if</span> (y &gt; <span class="hljs-keyword">this</span>.maxy) {
                        y = <span class="hljs-keyword">this</span>.maxy;
                    }
                    <span class="hljs-keyword">if</span> (!path.length) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-45" id="section-45"></a>
</div>
<p>previous value was null</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                        path.push([xpos, canvasTop + canvasHeight]);
                    }
                    vertex = [xpos, canvasTop + <span class="hljs-built_in">Math</span>.round(canvasHeight - (canvasHeight * ((y - <span class="hljs-keyword">this</span>.miny) / rangey)))];
                    path.push(vertex);
                    vertices.push(vertex);
                }
            }

            lineShapes = [];
            fillShapes = [];
            plen = paths.length;
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; plen; i++) {
                path = paths[i];
                <span class="hljs-keyword">if</span> (path.length) {
                    <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'fillColor'</span>)) {
                        path.push([path[path.length - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>], (canvasTop + canvasHeight)]);
                        fillShapes.push(path.slice(<span class="hljs-number">0</span>));
                        path.pop();
                    }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-46" id="section-46"></a>
</div>
<p>if there's only a single point in this path, then we want to display it
as a vertical line which means we keep path[0]  as is</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                    <span class="hljs-keyword">if</span> (path.length &gt; <span class="hljs-number">2</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-47" id="section-47"></a>
</div>
<p>else we want the first value</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                        path[<span class="hljs-number">0</span>] = [path[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>], path[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]];
                    }
                    lineShapes.push(path);
                }
            }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-48" id="section-48"></a>
</div>
<p>draw the fill first, then optionally the normal range, then the line on top of that</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            plen = fillShapes.length;
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; plen; i++) {
                target.drawShape(fillShapes[i],
                    options.get(<span class="hljs-string">'fillColor'</span>), options.get(<span class="hljs-string">'fillColor'</span>)).append();
            }

            <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'normalRangeMin'</span>) !== <span class="hljs-literal">undefined</span> &amp;&amp; options.get(<span class="hljs-string">'drawNormalOnTop'</span>)) {
                <span class="hljs-keyword">this</span>.drawNormalRange(canvasLeft, canvasTop, canvasHeight, canvasWidth, rangey);
            }

            plen = lineShapes.length;
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; plen; i++) {
                target.drawShape(lineShapes[i], options.get(<span class="hljs-string">'lineColor'</span>), <span class="hljs-literal">undefined</span>,
                    options.get(<span class="hljs-string">'lineWidth'</span>)).append();
            }

            <span class="hljs-keyword">if</span> (spotRadius &amp;&amp; options.get(<span class="hljs-string">'valueSpots'</span>)) {
                valueSpots = options.get(<span class="hljs-string">'valueSpots'</span>);
                <span class="hljs-keyword">if</span> (valueSpots.get === <span class="hljs-literal">undefined</span>) {
                    valueSpots = <span class="hljs-keyword">new</span> RangeMap(valueSpots);
                }
                <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; yvalcount; i++) {
                    color = valueSpots.get(yvalues[i]);
                    <span class="hljs-keyword">if</span> (color) {
                        target.drawCircle(canvasLeft + <span class="hljs-built_in">Math</span>.round((xvalues[i] - <span class="hljs-keyword">this</span>.minx) * (canvasWidth / rangex)),
                            canvasTop + <span class="hljs-built_in">Math</span>.round(canvasHeight - (canvasHeight * ((yvalues[i] - <span class="hljs-keyword">this</span>.miny) / rangey))),
                            spotRadius, <span class="hljs-literal">undefined</span>,
                            color).append();
                    }
                }

            }
            <span class="hljs-keyword">if</span> (spotRadius &amp;&amp; options.get(<span class="hljs-string">'spotColor'</span>) &amp;&amp; yvalues[yvallast] !== <span class="hljs-literal">null</span>) {
                target.drawCircle(canvasLeft + <span class="hljs-built_in">Math</span>.round((xvalues[xvalues.length - <span class="hljs-number">1</span>] - <span class="hljs-keyword">this</span>.minx) * (canvasWidth / rangex)),
                    canvasTop + <span class="hljs-built_in">Math</span>.round(canvasHeight - (canvasHeight * ((yvalues[yvallast] - <span class="hljs-keyword">this</span>.miny) / rangey))),
                    spotRadius, <span class="hljs-literal">undefined</span>,
                    options.get(<span class="hljs-string">'spotColor'</span>)).append();
            }
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.maxy !== <span class="hljs-keyword">this</span>.minyorg) {
                <span class="hljs-keyword">if</span> (spotRadius &amp;&amp; options.get(<span class="hljs-string">'minSpotColor'</span>)) {
                    x = xvalues[$.inArray(<span class="hljs-keyword">this</span>.minyorg, yvalues)];
                    target.drawCircle(canvasLeft + <span class="hljs-built_in">Math</span>.round((x - <span class="hljs-keyword">this</span>.minx) * (canvasWidth / rangex)),
                        canvasTop + <span class="hljs-built_in">Math</span>.round(canvasHeight - (canvasHeight * ((<span class="hljs-keyword">this</span>.minyorg - <span class="hljs-keyword">this</span>.miny) / rangey))),
                        spotRadius, <span class="hljs-literal">undefined</span>,
                        options.get(<span class="hljs-string">'minSpotColor'</span>)).append();
                }
                <span class="hljs-keyword">if</span> (spotRadius &amp;&amp; options.get(<span class="hljs-string">'maxSpotColor'</span>)) {
                    x = xvalues[$.inArray(<span class="hljs-keyword">this</span>.maxyorg, yvalues)];
                    target.drawCircle(canvasLeft + <span class="hljs-built_in">Math</span>.round((x - <span class="hljs-keyword">this</span>.minx) * (canvasWidth / rangex)),
                        canvasTop + <span class="hljs-built_in">Math</span>.round(canvasHeight - (canvasHeight * ((<span class="hljs-keyword">this</span>.maxyorg - <span class="hljs-keyword">this</span>.miny) / rangey))),
                        spotRadius, <span class="hljs-literal">undefined</span>,
                        options.get(<span class="hljs-string">'maxSpotColor'</span>)).append();
                }
            }

            <span class="hljs-keyword">this</span>.lastShapeId = target.getLastShapeId();
            <span class="hljs-keyword">this</span>.canvasTop = canvasTop;
            target.render();
        }
    });

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-49" id="section-49"></a>
</div>
<div class="dox">
<div class="summary">
<p>Bar charts</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">    $.fn.sparkline.bar = bar = createClass($.fn.sparkline._base, barHighlightMixin, {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'bar'</span>,

        <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el, values, options, width, height</span>) </span>{
            <span class="hljs-keyword">var</span> barWidth = <span class="hljs-built_in">parseInt</span>(options.get(<span class="hljs-string">'barWidth'</span>), <span class="hljs-number">10</span>),
                barSpacing = <span class="hljs-built_in">parseInt</span>(options.get(<span class="hljs-string">'barSpacing'</span>), <span class="hljs-number">10</span>),
                chartRangeMin = options.get(<span class="hljs-string">'chartRangeMin'</span>),
                chartRangeMax = options.get(<span class="hljs-string">'chartRangeMax'</span>),
                chartRangeClip = options.get(<span class="hljs-string">'chartRangeClip'</span>),
                stackMin = <span class="hljs-literal">Infinity</span>,
                stackMax = -<span class="hljs-literal">Infinity</span>,
                isStackString, groupMin, groupMax, stackRanges,
                numValues, i, vlen, range, zeroAxis, xaxisOffset, min, max, clipMin, clipMax,
                stacked, vlist, j, slen, svals, val, yoffset, yMaxCalc, canvasHeightEf;
            bar._super.init.call(<span class="hljs-keyword">this</span>, el, values, options, width, height);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-50" id="section-50"></a>
</div>
<p>scan values to determine whether to stack bars</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, vlen = values.length; i &lt; vlen; i++) {
                val = values[i];
                isStackString = <span class="hljs-keyword">typeof</span>(val) === <span class="hljs-string">'string'</span> &amp;&amp; val.indexOf(<span class="hljs-string">':'</span>) &gt; <span class="hljs-number">-1</span>;
                <span class="hljs-keyword">if</span> (isStackString || $.isArray(val)) {
                    stacked = <span class="hljs-literal">true</span>;
                    <span class="hljs-keyword">if</span> (isStackString) {
                        val = values[i] = normalizeValues(val.split(<span class="hljs-string">':'</span>));
                    }
                    val = remove(val, <span class="hljs-literal">null</span>); <span class="hljs-comment">// min/max will treat null as zero</span>
                    groupMin = <span class="hljs-built_in">Math</span>.min.apply(<span class="hljs-built_in">Math</span>, val);
                    groupMax = <span class="hljs-built_in">Math</span>.max.apply(<span class="hljs-built_in">Math</span>, val);
                    <span class="hljs-keyword">if</span> (groupMin &lt; stackMin) {
                        stackMin = groupMin;
                    }
                    <span class="hljs-keyword">if</span> (groupMax &gt; stackMax) {
                        stackMax = groupMax;
                    }
                }
            }

            <span class="hljs-keyword">this</span>.stacked = stacked;
            <span class="hljs-keyword">this</span>.regionShapes = {};
            <span class="hljs-keyword">this</span>.barWidth = barWidth;
            <span class="hljs-keyword">this</span>.barSpacing = barSpacing;
            <span class="hljs-keyword">this</span>.totalBarWidth = barWidth + barSpacing;
            <span class="hljs-keyword">this</span>.width = width = (values.length * barWidth) + ((values.length - <span class="hljs-number">1</span>) * barSpacing);

            <span class="hljs-keyword">this</span>.initTarget();

            <span class="hljs-keyword">if</span> (chartRangeClip) {
                clipMin = chartRangeMin === <span class="hljs-literal">undefined</span> ? -<span class="hljs-literal">Infinity</span> : chartRangeMin;
                clipMax = chartRangeMax === <span class="hljs-literal">undefined</span> ? <span class="hljs-literal">Infinity</span> : chartRangeMax;
            }

            numValues = [];
            stackRanges = stacked ? [] : numValues;
            <span class="hljs-keyword">var</span> stackTotals = [];
            <span class="hljs-keyword">var</span> stackRangesNeg = [];
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, vlen = values.length; i &lt; vlen; i++) {
                <span class="hljs-keyword">if</span> (stacked) {
                    vlist = values[i];
                    values[i] = svals = [];
                    stackTotals[i] = <span class="hljs-number">0</span>;
                    stackRanges[i] = stackRangesNeg[i] = <span class="hljs-number">0</span>;
                    <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>, slen = vlist.length; j &lt; slen; j++) {
                        val = svals[j] = chartRangeClip ? clipval(vlist[j], clipMin, clipMax) : vlist[j];
                        <span class="hljs-keyword">if</span> (val !== <span class="hljs-literal">null</span>) {
                            <span class="hljs-keyword">if</span> (val &gt; <span class="hljs-number">0</span>) {
                                stackTotals[i] += val;
                            }
                            <span class="hljs-keyword">if</span> (stackMin &lt; <span class="hljs-number">0</span> &amp;&amp; stackMax &gt; <span class="hljs-number">0</span>) {
                                <span class="hljs-keyword">if</span> (val &lt; <span class="hljs-number">0</span>) {
                                    stackRangesNeg[i] += <span class="hljs-built_in">Math</span>.abs(val);
                                } <span class="hljs-keyword">else</span> {
                                    stackRanges[i] += val;
                                }
                            } <span class="hljs-keyword">else</span> {
                                stackRanges[i] += <span class="hljs-built_in">Math</span>.abs(val - (val &lt; <span class="hljs-number">0</span> ? stackMax : stackMin));
                            }
                            numValues.push(val);
                        }
                    }
                } <span class="hljs-keyword">else</span> {
                    val = chartRangeClip ? clipval(values[i], clipMin, clipMax) : values[i];
                    val = values[i] = normalizeValue(val);
                    <span class="hljs-keyword">if</span> (val !== <span class="hljs-literal">null</span>) {
                        numValues.push(val);
                    }
                }
            }
            <span class="hljs-keyword">this</span>.max = max = <span class="hljs-built_in">Math</span>.max.apply(<span class="hljs-built_in">Math</span>, numValues);
            <span class="hljs-keyword">this</span>.min = min = <span class="hljs-built_in">Math</span>.min.apply(<span class="hljs-built_in">Math</span>, numValues);
            <span class="hljs-keyword">this</span>.stackMax = stackMax = stacked ? <span class="hljs-built_in">Math</span>.max.apply(<span class="hljs-built_in">Math</span>, stackTotals) : max;
            <span class="hljs-keyword">this</span>.stackMin = stackMin = stacked ? <span class="hljs-built_in">Math</span>.min.apply(<span class="hljs-built_in">Math</span>, numValues) : min;

            <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'chartRangeMin'</span>) !== <span class="hljs-literal">undefined</span> &amp;&amp; (options.get(<span class="hljs-string">'chartRangeClip'</span>) || options.get(<span class="hljs-string">'chartRangeMin'</span>) &lt; min)) {
                min = options.get(<span class="hljs-string">'chartRangeMin'</span>);
            }
            <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'chartRangeMax'</span>) !== <span class="hljs-literal">undefined</span> &amp;&amp; (options.get(<span class="hljs-string">'chartRangeClip'</span>) || options.get(<span class="hljs-string">'chartRangeMax'</span>) &gt; max)) {
                max = options.get(<span class="hljs-string">'chartRangeMax'</span>);
            }

            <span class="hljs-keyword">this</span>.zeroAxis = zeroAxis = options.get(<span class="hljs-string">'zeroAxis'</span>, <span class="hljs-literal">true</span>);
            <span class="hljs-keyword">if</span> (min &lt;= <span class="hljs-number">0</span> &amp;&amp; max &gt;= <span class="hljs-number">0</span> &amp;&amp; zeroAxis) {
                xaxisOffset = <span class="hljs-number">0</span>;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (zeroAxis == <span class="hljs-literal">false</span>) {
                xaxisOffset = min;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (min &gt; <span class="hljs-number">0</span>) {
                xaxisOffset = min;
            } <span class="hljs-keyword">else</span> {
                xaxisOffset = max;
            }
            <span class="hljs-keyword">this</span>.xaxisOffset = xaxisOffset;

            range = stacked ? (<span class="hljs-built_in">Math</span>.max.apply(<span class="hljs-built_in">Math</span>, stackRanges) + <span class="hljs-built_in">Math</span>.max.apply(<span class="hljs-built_in">Math</span>, stackRangesNeg)) : max - min;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-51" id="section-51"></a>
</div>
<p>as we plot zero/min values a single pixel line, we add a pixel to all other
values - Reduce the effective canvas size to suit</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">this</span>.canvasHeightEf = (zeroAxis &amp;&amp; min &lt; <span class="hljs-number">0</span>) ? <span class="hljs-keyword">this</span>.canvasHeight - <span class="hljs-number">2</span> : <span class="hljs-keyword">this</span>.canvasHeight - <span class="hljs-number">1</span>;

            <span class="hljs-keyword">if</span> (min &lt; xaxisOffset) {
                yMaxCalc = (stacked &amp;&amp; max &gt;= <span class="hljs-number">0</span>) ? stackMax : max;
                yoffset = (yMaxCalc - xaxisOffset) / range * <span class="hljs-keyword">this</span>.canvasHeight;
                <span class="hljs-keyword">if</span> (yoffset !== <span class="hljs-built_in">Math</span>.ceil(yoffset)) {
                    <span class="hljs-keyword">this</span>.canvasHeightEf -= <span class="hljs-number">2</span>;
                    yoffset = <span class="hljs-built_in">Math</span>.ceil(yoffset);
                }
            } <span class="hljs-keyword">else</span> {
                yoffset = <span class="hljs-keyword">this</span>.canvasHeight;
            }
            <span class="hljs-keyword">this</span>.yoffset = yoffset;

            <span class="hljs-keyword">if</span> ($.isArray(options.get(<span class="hljs-string">'colorMap'</span>))) {
                <span class="hljs-keyword">this</span>.colorMapByIndex = options.get(<span class="hljs-string">'colorMap'</span>);
                <span class="hljs-keyword">this</span>.colorMapByValue = <span class="hljs-literal">null</span>;
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">this</span>.colorMapByIndex = <span class="hljs-literal">null</span>;
                <span class="hljs-keyword">this</span>.colorMapByValue = options.get(<span class="hljs-string">'colorMap'</span>);
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.colorMapByValue &amp;&amp; <span class="hljs-keyword">this</span>.colorMapByValue.get === <span class="hljs-literal">undefined</span>) {
                    <span class="hljs-keyword">this</span>.colorMapByValue = <span class="hljs-keyword">new</span> RangeMap(<span class="hljs-keyword">this</span>.colorMapByValue);
                }
            }

            <span class="hljs-keyword">this</span>.range = range;
        },

        <span class="hljs-attr">getRegion</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el, x, y</span>) </span>{
            <span class="hljs-keyword">var</span> result = <span class="hljs-built_in">Math</span>.floor(x / <span class="hljs-keyword">this</span>.totalBarWidth);
            <span class="hljs-keyword">return</span> (result &lt; <span class="hljs-number">0</span> || result &gt;= <span class="hljs-keyword">this</span>.values.length) ? <span class="hljs-literal">undefined</span> : result;
        },

        <span class="hljs-attr">getCurrentRegionFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> currentRegion = <span class="hljs-keyword">this</span>.currentRegion,
                values = ensureArray(<span class="hljs-keyword">this</span>.values[currentRegion]),
                result = [],
                value, i;
            <span class="hljs-keyword">for</span> (i = values.length; i--;) {
                value = values[i];
                result.push({
                    <span class="hljs-attr">isNull</span>: value === <span class="hljs-literal">null</span>,
                    <span class="hljs-attr">value</span>: value,
                    <span class="hljs-attr">color</span>: <span class="hljs-keyword">this</span>.calcColor(i, value, currentRegion),
                    <span class="hljs-attr">offset</span>: currentRegion
                });
            }
            <span class="hljs-keyword">return</span> result;
        },

        <span class="hljs-attr">calcColor</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">stacknum, value, valuenum</span>) </span>{
            <span class="hljs-keyword">var</span> colorMapByIndex = <span class="hljs-keyword">this</span>.colorMapByIndex,
                colorMapByValue = <span class="hljs-keyword">this</span>.colorMapByValue,
                options = <span class="hljs-keyword">this</span>.options,
                color, newColor;
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.stacked) {
                color = options.get(<span class="hljs-string">'stackedBarColor'</span>);
            } <span class="hljs-keyword">else</span> {
                color = (value &lt; <span class="hljs-number">0</span>) ? options.get(<span class="hljs-string">'negBarColor'</span>) : options.get(<span class="hljs-string">'barColor'</span>);
            }
            <span class="hljs-keyword">if</span> (value === <span class="hljs-number">0</span> &amp;&amp; options.get(<span class="hljs-string">'zeroColor'</span>) !== <span class="hljs-literal">undefined</span>) {
                color = options.get(<span class="hljs-string">'zeroColor'</span>);
            }
            <span class="hljs-keyword">if</span> (colorMapByValue &amp;&amp; (newColor = colorMapByValue.get(value))) {
                color = newColor;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (colorMapByIndex &amp;&amp; colorMapByIndex.length &gt; valuenum) {
                color = colorMapByIndex[valuenum];
            }
            <span class="hljs-keyword">return</span> $.isArray(color) ? color[stacknum % color.length] : color;
        },

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-52" id="section-52"></a>
</div>
<div class="dox">
<div class="summary">
<p>Render bar(s) for a region</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">        renderRegion: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">valuenum, highlight</span>) </span>{
            <span class="hljs-keyword">var</span> vals = <span class="hljs-keyword">this</span>.values[valuenum],
                options = <span class="hljs-keyword">this</span>.options,
                xaxisOffset = <span class="hljs-keyword">this</span>.xaxisOffset,
                result = [],
                range = <span class="hljs-keyword">this</span>.range,
                stacked = <span class="hljs-keyword">this</span>.stacked,
                target = <span class="hljs-keyword">this</span>.target,
                x = valuenum * <span class="hljs-keyword">this</span>.totalBarWidth,
                canvasHeightEf = <span class="hljs-keyword">this</span>.canvasHeightEf,
                yoffset = <span class="hljs-keyword">this</span>.yoffset,
                y, height, color, isNull, yoffsetNeg, i, valcount, val, minPlotted, allMin;

            vals = $.isArray(vals) ? vals : [vals];
            valcount = vals.length;
            val = vals[<span class="hljs-number">0</span>];
            isNull = all(<span class="hljs-literal">null</span>, vals);
            allMin = all(xaxisOffset, vals, <span class="hljs-literal">true</span>);

            <span class="hljs-keyword">if</span> (isNull) {
                <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'nullColor'</span>)) {
                    color = highlight ? options.get(<span class="hljs-string">'nullColor'</span>) : <span class="hljs-keyword">this</span>.calcHighlightColor(options.get(<span class="hljs-string">'nullColor'</span>), options);
                    y = (yoffset &gt; <span class="hljs-number">0</span>) ? yoffset - <span class="hljs-number">1</span> : yoffset;
                    <span class="hljs-keyword">return</span> target.drawRect(x, y, <span class="hljs-keyword">this</span>.barWidth - <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, color, color);
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;
                }
            }
            yoffsetNeg = yoffset;
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; valcount; i++) {
                val = vals[i];

                <span class="hljs-keyword">if</span> (stacked &amp;&amp; val === xaxisOffset) {
                    <span class="hljs-keyword">if</span> (!allMin || minPlotted) {
                        <span class="hljs-keyword">continue</span>;
                    }
                    minPlotted = <span class="hljs-literal">true</span>;
                }

                <span class="hljs-keyword">if</span> (range &gt; <span class="hljs-number">0</span>) {
                    height = <span class="hljs-built_in">Math</span>.floor(canvasHeightEf * ((<span class="hljs-built_in">Math</span>.abs(val - xaxisOffset) / range))) + <span class="hljs-number">1</span>;
                } <span class="hljs-keyword">else</span> {
                    height = <span class="hljs-number">1</span>;
                }
                <span class="hljs-keyword">if</span> (val &lt; xaxisOffset || (val === xaxisOffset &amp;&amp; yoffset === <span class="hljs-number">0</span>)) {
                    y = yoffsetNeg;
                    yoffsetNeg += height;
                } <span class="hljs-keyword">else</span> {
                    y = yoffset - height;
                    yoffset -= height;
                }
                color = <span class="hljs-keyword">this</span>.calcColor(i, val, valuenum);
                <span class="hljs-keyword">if</span> (highlight) {
                    color = <span class="hljs-keyword">this</span>.calcHighlightColor(color, options);
                }
                result.push(target.drawRect(x, y, <span class="hljs-keyword">this</span>.barWidth - <span class="hljs-number">1</span>, height - <span class="hljs-number">1</span>, color, color));
            }
            <span class="hljs-keyword">if</span> (result.length === <span class="hljs-number">1</span>) {
                <span class="hljs-keyword">return</span> result[<span class="hljs-number">0</span>];
            }
            <span class="hljs-keyword">return</span> result;
        }
    });

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-53" id="section-53"></a>
</div>
<div class="dox">
<div class="summary">
<p>Tristate charts</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">    $.fn.sparkline.tristate = tristate = createClass($.fn.sparkline._base, barHighlightMixin, {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'tristate'</span>,

        <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el, values, options, width, height</span>) </span>{
            <span class="hljs-keyword">var</span> barWidth = <span class="hljs-built_in">parseInt</span>(options.get(<span class="hljs-string">'barWidth'</span>), <span class="hljs-number">10</span>),
                barSpacing = <span class="hljs-built_in">parseInt</span>(options.get(<span class="hljs-string">'barSpacing'</span>), <span class="hljs-number">10</span>);
            tristate._super.init.call(<span class="hljs-keyword">this</span>, el, values, options, width, height);

            <span class="hljs-keyword">this</span>.regionShapes = {};
            <span class="hljs-keyword">this</span>.barWidth = barWidth;
            <span class="hljs-keyword">this</span>.barSpacing = barSpacing;
            <span class="hljs-keyword">this</span>.totalBarWidth = barWidth + barSpacing;
            <span class="hljs-keyword">this</span>.values = $.map(values, <span class="hljs-built_in">Number</span>);
            <span class="hljs-keyword">this</span>.width = width = (values.length * barWidth) + ((values.length - <span class="hljs-number">1</span>) * barSpacing);

            <span class="hljs-keyword">if</span> ($.isArray(options.get(<span class="hljs-string">'colorMap'</span>))) {
                <span class="hljs-keyword">this</span>.colorMapByIndex = options.get(<span class="hljs-string">'colorMap'</span>);
                <span class="hljs-keyword">this</span>.colorMapByValue = <span class="hljs-literal">null</span>;
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">this</span>.colorMapByIndex = <span class="hljs-literal">null</span>;
                <span class="hljs-keyword">this</span>.colorMapByValue = options.get(<span class="hljs-string">'colorMap'</span>);
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.colorMapByValue &amp;&amp; <span class="hljs-keyword">this</span>.colorMapByValue.get === <span class="hljs-literal">undefined</span>) {
                    <span class="hljs-keyword">this</span>.colorMapByValue = <span class="hljs-keyword">new</span> RangeMap(<span class="hljs-keyword">this</span>.colorMapByValue);
                }
            }
            <span class="hljs-keyword">this</span>.initTarget();
        },

        <span class="hljs-attr">getRegion</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el, x, y</span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.floor(x / <span class="hljs-keyword">this</span>.totalBarWidth);
        },

        <span class="hljs-attr">getCurrentRegionFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> currentRegion = <span class="hljs-keyword">this</span>.currentRegion;
            <span class="hljs-keyword">return</span> {
                <span class="hljs-attr">isNull</span>: <span class="hljs-keyword">this</span>.values[currentRegion] === <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">value</span>: <span class="hljs-keyword">this</span>.values[currentRegion],
                <span class="hljs-attr">color</span>: <span class="hljs-keyword">this</span>.calcColor(<span class="hljs-keyword">this</span>.values[currentRegion], currentRegion),
                <span class="hljs-attr">offset</span>: currentRegion
            };
        },

        <span class="hljs-attr">calcColor</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">value, valuenum</span>) </span>{
            <span class="hljs-keyword">var</span> values = <span class="hljs-keyword">this</span>.values,
                options = <span class="hljs-keyword">this</span>.options,
                colorMapByIndex = <span class="hljs-keyword">this</span>.colorMapByIndex,
                colorMapByValue = <span class="hljs-keyword">this</span>.colorMapByValue,
                color, newColor;

            <span class="hljs-keyword">if</span> (colorMapByValue &amp;&amp; (newColor = colorMapByValue.get(value))) {
                color = newColor;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (colorMapByIndex &amp;&amp; colorMapByIndex.length &gt; valuenum) {
                color = colorMapByIndex[valuenum];
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (values[valuenum] &lt; <span class="hljs-number">0</span>) {
                color = options.get(<span class="hljs-string">'negBarColor'</span>);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (values[valuenum] &gt; <span class="hljs-number">0</span>) {
                color = options.get(<span class="hljs-string">'posBarColor'</span>);
            } <span class="hljs-keyword">else</span> {
                color = options.get(<span class="hljs-string">'zeroBarColor'</span>);
            }
            <span class="hljs-keyword">return</span> color;
        },

        <span class="hljs-attr">renderRegion</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">valuenum, highlight</span>) </span>{
            <span class="hljs-keyword">var</span> values = <span class="hljs-keyword">this</span>.values,
                options = <span class="hljs-keyword">this</span>.options,
                target = <span class="hljs-keyword">this</span>.target,
                canvasHeight, height, halfHeight,
                x, y, color;

            canvasHeight = target.pixelHeight;
            halfHeight = <span class="hljs-built_in">Math</span>.round(canvasHeight / <span class="hljs-number">2</span>);

            x = valuenum * <span class="hljs-keyword">this</span>.totalBarWidth;
            <span class="hljs-keyword">if</span> (values[valuenum] &lt; <span class="hljs-number">0</span>) {
                y = halfHeight;
                height = halfHeight - <span class="hljs-number">1</span>;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (values[valuenum] &gt; <span class="hljs-number">0</span>) {
                y = <span class="hljs-number">0</span>;
                height = halfHeight - <span class="hljs-number">1</span>;
            } <span class="hljs-keyword">else</span> {
                y = halfHeight - <span class="hljs-number">1</span>;
                height = <span class="hljs-number">2</span>;
            }
            color = <span class="hljs-keyword">this</span>.calcColor(values[valuenum], valuenum);
            <span class="hljs-keyword">if</span> (color === <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">return</span>;
            }
            <span class="hljs-keyword">if</span> (highlight) {
                color = <span class="hljs-keyword">this</span>.calcHighlightColor(color, options);
            }
            <span class="hljs-keyword">return</span> target.drawRect(x, y, <span class="hljs-keyword">this</span>.barWidth - <span class="hljs-number">1</span>, height - <span class="hljs-number">1</span>, color, color);
        }
    });

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-54" id="section-54"></a>
</div>
<div class="dox">
<div class="summary">
<p>Discrete charts</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">    $.fn.sparkline.discrete = discrete = createClass($.fn.sparkline._base, barHighlightMixin, {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'discrete'</span>,

        <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el, values, options, width, height</span>) </span>{
            discrete._super.init.call(<span class="hljs-keyword">this</span>, el, values, options, width, height);

            <span class="hljs-keyword">this</span>.regionShapes = {};
            <span class="hljs-keyword">this</span>.values = values = $.map(values, <span class="hljs-built_in">Number</span>);
            <span class="hljs-keyword">this</span>.min = <span class="hljs-built_in">Math</span>.min.apply(<span class="hljs-built_in">Math</span>, values);
            <span class="hljs-keyword">this</span>.max = <span class="hljs-built_in">Math</span>.max.apply(<span class="hljs-built_in">Math</span>, values);
            <span class="hljs-keyword">this</span>.range = <span class="hljs-keyword">this</span>.max - <span class="hljs-keyword">this</span>.min;
            <span class="hljs-keyword">this</span>.width = width = options.get(<span class="hljs-string">'width'</span>) === <span class="hljs-string">'auto'</span> ? values.length * <span class="hljs-number">2</span> : <span class="hljs-keyword">this</span>.width;
            <span class="hljs-keyword">this</span>.interval = <span class="hljs-built_in">Math</span>.floor(width / values.length);
            <span class="hljs-keyword">this</span>.itemWidth = width / values.length;
            <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'chartRangeMin'</span>) !== <span class="hljs-literal">undefined</span> &amp;&amp; (options.get(<span class="hljs-string">'chartRangeClip'</span>) || options.get(<span class="hljs-string">'chartRangeMin'</span>) &lt; <span class="hljs-keyword">this</span>.min)) {
                <span class="hljs-keyword">this</span>.min = options.get(<span class="hljs-string">'chartRangeMin'</span>);
            }
            <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'chartRangeMax'</span>) !== <span class="hljs-literal">undefined</span> &amp;&amp; (options.get(<span class="hljs-string">'chartRangeClip'</span>) || options.get(<span class="hljs-string">'chartRangeMax'</span>) &gt; <span class="hljs-keyword">this</span>.max)) {
                <span class="hljs-keyword">this</span>.max = options.get(<span class="hljs-string">'chartRangeMax'</span>);
            }
            <span class="hljs-keyword">this</span>.initTarget();
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.target) {
                <span class="hljs-keyword">this</span>.lineHeight = options.get(<span class="hljs-string">'lineHeight'</span>) === <span class="hljs-string">'auto'</span> ? <span class="hljs-built_in">Math</span>.round(<span class="hljs-keyword">this</span>.canvasHeight * <span class="hljs-number">0.3</span>) : options.get(<span class="hljs-string">'lineHeight'</span>);
            }
        },

        <span class="hljs-attr">getRegion</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el, x, y</span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.floor(x / <span class="hljs-keyword">this</span>.itemWidth);
        },

        <span class="hljs-attr">getCurrentRegionFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> currentRegion = <span class="hljs-keyword">this</span>.currentRegion;
            <span class="hljs-keyword">return</span> {
                <span class="hljs-attr">isNull</span>: <span class="hljs-keyword">this</span>.values[currentRegion] === <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">value</span>: <span class="hljs-keyword">this</span>.values[currentRegion],
                <span class="hljs-attr">offset</span>: currentRegion
            };
        },

        <span class="hljs-attr">renderRegion</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">valuenum, highlight</span>) </span>{
            <span class="hljs-keyword">var</span> values = <span class="hljs-keyword">this</span>.values,
                options = <span class="hljs-keyword">this</span>.options,
                min = <span class="hljs-keyword">this</span>.min,
                max = <span class="hljs-keyword">this</span>.max,
                range = <span class="hljs-keyword">this</span>.range,
                interval = <span class="hljs-keyword">this</span>.interval,
                target = <span class="hljs-keyword">this</span>.target,
                canvasHeight = <span class="hljs-keyword">this</span>.canvasHeight,
                lineHeight = <span class="hljs-keyword">this</span>.lineHeight,
                pheight = canvasHeight - lineHeight,
                ytop, val, color, x;

            val = clipval(values[valuenum], min, max);
            x = valuenum * interval;
            ytop = <span class="hljs-built_in">Math</span>.round(pheight - pheight * ((val - min) / range));
            color = (options.get(<span class="hljs-string">'thresholdColor'</span>) &amp;&amp; val &lt; options.get(<span class="hljs-string">'thresholdValue'</span>)) ? options.get(<span class="hljs-string">'thresholdColor'</span>) : options.get(<span class="hljs-string">'lineColor'</span>);
            <span class="hljs-keyword">if</span> (highlight) {
                color = <span class="hljs-keyword">this</span>.calcHighlightColor(color, options);
            }
            <span class="hljs-keyword">return</span> target.drawLine(x, ytop, x, ytop + lineHeight, color);
        }
    });

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-55" id="section-55"></a>
</div>
<div class="dox">
<div class="summary">
<p>Bullet charts</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">    $.fn.sparkline.bullet = bullet = createClass($.fn.sparkline._base, {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'bullet'</span>,

        <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el, values, options, width, height</span>) </span>{
            <span class="hljs-keyword">var</span> min, max, vals;
            bullet._super.init.call(<span class="hljs-keyword">this</span>, el, values, options, width, height);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-56" id="section-56"></a>
</div>
<p>values: target, performance, range1, range2, range3</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">this</span>.values = values = normalizeValues(values);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-57" id="section-57"></a>
</div>
<p>target or performance could be null</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            vals = values.slice();
            vals[<span class="hljs-number">0</span>] = vals[<span class="hljs-number">0</span>] === <span class="hljs-literal">null</span> ? vals[<span class="hljs-number">2</span>] : vals[<span class="hljs-number">0</span>];
            vals[<span class="hljs-number">1</span>] = values[<span class="hljs-number">1</span>] === <span class="hljs-literal">null</span> ? vals[<span class="hljs-number">2</span>] : vals[<span class="hljs-number">1</span>];
            min = <span class="hljs-built_in">Math</span>.min.apply(<span class="hljs-built_in">Math</span>, values);
            max = <span class="hljs-built_in">Math</span>.max.apply(<span class="hljs-built_in">Math</span>, values);
            <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'base'</span>) === <span class="hljs-literal">undefined</span>) {
                min = min &lt; <span class="hljs-number">0</span> ? min : <span class="hljs-number">0</span>;
            } <span class="hljs-keyword">else</span> {
                min = options.get(<span class="hljs-string">'base'</span>);
            }
            <span class="hljs-keyword">this</span>.min = min;
            <span class="hljs-keyword">this</span>.max = max;
            <span class="hljs-keyword">this</span>.range = max - min;
            <span class="hljs-keyword">this</span>.shapes = {};
            <span class="hljs-keyword">this</span>.valueShapes = {};
            <span class="hljs-keyword">this</span>.regiondata = {};
            <span class="hljs-keyword">this</span>.width = width = options.get(<span class="hljs-string">'width'</span>) === <span class="hljs-string">'auto'</span> ? <span class="hljs-string">'4.0em'</span> : width;
            <span class="hljs-keyword">this</span>.target = <span class="hljs-keyword">this</span>.$el.simpledraw(width, height, options.get(<span class="hljs-string">'composite'</span>));
            <span class="hljs-keyword">if</span> (!values.length) {
                <span class="hljs-keyword">this</span>.disabled = <span class="hljs-literal">true</span>;
            }
            <span class="hljs-keyword">this</span>.initTarget();
        },

        <span class="hljs-attr">getRegion</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el, x, y</span>) </span>{
            <span class="hljs-keyword">var</span> shapeid = <span class="hljs-keyword">this</span>.target.getShapeAt(el, x, y);
            <span class="hljs-keyword">return</span> (shapeid !== <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-keyword">this</span>.shapes[shapeid] !== <span class="hljs-literal">undefined</span>) ? <span class="hljs-keyword">this</span>.shapes[shapeid] : <span class="hljs-literal">undefined</span>;
        },

        <span class="hljs-attr">getCurrentRegionFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> currentRegion = <span class="hljs-keyword">this</span>.currentRegion;
            <span class="hljs-keyword">return</span> {
                <span class="hljs-attr">fieldkey</span>: currentRegion.substr(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>),
                <span class="hljs-attr">value</span>: <span class="hljs-keyword">this</span>.values[currentRegion.substr(<span class="hljs-number">1</span>)],
                <span class="hljs-attr">region</span>: currentRegion
            };
        },

        <span class="hljs-attr">changeHighlight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">highlight</span>) </span>{
            <span class="hljs-keyword">var</span> currentRegion = <span class="hljs-keyword">this</span>.currentRegion,
                shapeid = <span class="hljs-keyword">this</span>.valueShapes[currentRegion],
                shape;
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.shapes[shapeid];
            <span class="hljs-keyword">switch</span> (currentRegion.substr(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) {
                <span class="hljs-keyword">case</span> <span class="hljs-string">'r'</span>:
                    shape = <span class="hljs-keyword">this</span>.renderRange(currentRegion.substr(<span class="hljs-number">1</span>), highlight);
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-string">'p'</span>:
                    shape = <span class="hljs-keyword">this</span>.renderPerformance(highlight);
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-string">'t'</span>:
                    shape = <span class="hljs-keyword">this</span>.renderTarget(highlight);
                    <span class="hljs-keyword">break</span>;
            }
            <span class="hljs-keyword">this</span>.valueShapes[currentRegion] = shape.id;
            <span class="hljs-keyword">this</span>.shapes[shape.id] = currentRegion;
            <span class="hljs-keyword">this</span>.target.replaceWithShape(shapeid, shape);
        },

        <span class="hljs-attr">renderRange</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">rn, highlight</span>) </span>{
            <span class="hljs-keyword">var</span> rangeval = <span class="hljs-keyword">this</span>.values[rn],
                rangewidth = <span class="hljs-built_in">Math</span>.round(<span class="hljs-keyword">this</span>.canvasWidth * ((rangeval - <span class="hljs-keyword">this</span>.min) / <span class="hljs-keyword">this</span>.range)),
                color = <span class="hljs-keyword">this</span>.options.get(<span class="hljs-string">'rangeColors'</span>)[rn - <span class="hljs-number">2</span>];
            <span class="hljs-keyword">if</span> (highlight) {
                color = <span class="hljs-keyword">this</span>.calcHighlightColor(color, <span class="hljs-keyword">this</span>.options);
            }
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.target.drawRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, rangewidth - <span class="hljs-number">1</span>, <span class="hljs-keyword">this</span>.canvasHeight - <span class="hljs-number">1</span>, color, color);
        },

        <span class="hljs-attr">renderPerformance</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">highlight</span>) </span>{
            <span class="hljs-keyword">var</span> perfval = <span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>],
                perfwidth = <span class="hljs-built_in">Math</span>.round(<span class="hljs-keyword">this</span>.canvasWidth * ((perfval - <span class="hljs-keyword">this</span>.min) / <span class="hljs-keyword">this</span>.range)),
                color = <span class="hljs-keyword">this</span>.options.get(<span class="hljs-string">'performanceColor'</span>);
            <span class="hljs-keyword">if</span> (highlight) {
                color = <span class="hljs-keyword">this</span>.calcHighlightColor(color, <span class="hljs-keyword">this</span>.options);
            }
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.target.drawRect(<span class="hljs-number">0</span>, <span class="hljs-built_in">Math</span>.round(<span class="hljs-keyword">this</span>.canvasHeight * <span class="hljs-number">0.3</span>), perfwidth - <span class="hljs-number">1</span>,
                <span class="hljs-built_in">Math</span>.round(<span class="hljs-keyword">this</span>.canvasHeight * <span class="hljs-number">0.4</span>) - <span class="hljs-number">1</span>, color, color);
        },

        <span class="hljs-attr">renderTarget</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">highlight</span>) </span>{
            <span class="hljs-keyword">var</span> targetval = <span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>],
                x = <span class="hljs-built_in">Math</span>.round(<span class="hljs-keyword">this</span>.canvasWidth * ((targetval - <span class="hljs-keyword">this</span>.min) / <span class="hljs-keyword">this</span>.range) - (<span class="hljs-keyword">this</span>.options.get(<span class="hljs-string">'targetWidth'</span>) / <span class="hljs-number">2</span>)),
                targettop = <span class="hljs-built_in">Math</span>.round(<span class="hljs-keyword">this</span>.canvasHeight * <span class="hljs-number">0.10</span>),
                targetheight = <span class="hljs-keyword">this</span>.canvasHeight - (targettop * <span class="hljs-number">2</span>),
                color = <span class="hljs-keyword">this</span>.options.get(<span class="hljs-string">'targetColor'</span>);
            <span class="hljs-keyword">if</span> (highlight) {
                color = <span class="hljs-keyword">this</span>.calcHighlightColor(color, <span class="hljs-keyword">this</span>.options);
            }
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.target.drawRect(x, targettop, <span class="hljs-keyword">this</span>.options.get(<span class="hljs-string">'targetWidth'</span>) - <span class="hljs-number">1</span>, targetheight - <span class="hljs-number">1</span>, color, color);
        },

        <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> vlen = <span class="hljs-keyword">this</span>.values.length,
                target = <span class="hljs-keyword">this</span>.target,
                i, shape;
            <span class="hljs-keyword">if</span> (!bullet._super.render.call(<span class="hljs-keyword">this</span>)) {
                <span class="hljs-keyword">return</span>;
            }
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">2</span>; i &lt; vlen; i++) {
                shape = <span class="hljs-keyword">this</span>.renderRange(i).append();
                <span class="hljs-keyword">this</span>.shapes[shape.id] = <span class="hljs-string">'r'</span> + i;
                <span class="hljs-keyword">this</span>.valueShapes[<span class="hljs-string">'r'</span> + i] = shape.id;
            }
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.values[<span class="hljs-number">1</span>] !== <span class="hljs-literal">null</span>) {
                shape = <span class="hljs-keyword">this</span>.renderPerformance().append();
                <span class="hljs-keyword">this</span>.shapes[shape.id] = <span class="hljs-string">'p1'</span>;
                <span class="hljs-keyword">this</span>.valueShapes.p1 = shape.id;
            }
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.values[<span class="hljs-number">0</span>] !== <span class="hljs-literal">null</span>) {
                shape = <span class="hljs-keyword">this</span>.renderTarget().append();
                <span class="hljs-keyword">this</span>.shapes[shape.id] = <span class="hljs-string">'t0'</span>;
                <span class="hljs-keyword">this</span>.valueShapes.t0 = shape.id;
            }
            target.render();
        }
    });

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-58" id="section-58"></a>
</div>
<div class="dox">
<div class="summary">
<p>Pie charts</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">    $.fn.sparkline.pie = pie = createClass($.fn.sparkline._base, {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'pie'</span>,

        <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el, values, options, width, height</span>) </span>{
            <span class="hljs-keyword">var</span> total = <span class="hljs-number">0</span>, i;

            pie._super.init.call(<span class="hljs-keyword">this</span>, el, values, options, width, height);

            <span class="hljs-keyword">this</span>.shapes = {}; <span class="hljs-comment">// map shape ids to value offsets</span>
            <span class="hljs-keyword">this</span>.valueShapes = {}; <span class="hljs-comment">// maps value offsets to shape ids</span>
            <span class="hljs-keyword">this</span>.values = values = $.map(values, <span class="hljs-built_in">Number</span>);

            <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'width'</span>) === <span class="hljs-string">'auto'</span>) {
                <span class="hljs-keyword">this</span>.width = <span class="hljs-keyword">this</span>.height;
            }

            <span class="hljs-keyword">if</span> (values.length &gt; <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">for</span> (i = values.length; i--;) {
                    total += values[i];
                }
            }
            <span class="hljs-keyword">this</span>.total = total;
            <span class="hljs-keyword">this</span>.initTarget();
            <span class="hljs-keyword">this</span>.radius = <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.min(<span class="hljs-keyword">this</span>.canvasWidth, <span class="hljs-keyword">this</span>.canvasHeight) / <span class="hljs-number">2</span>);
        },

        <span class="hljs-attr">getRegion</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el, x, y</span>) </span>{
            <span class="hljs-keyword">var</span> shapeid = <span class="hljs-keyword">this</span>.target.getShapeAt(el, x, y);
            <span class="hljs-keyword">return</span> (shapeid !== <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-keyword">this</span>.shapes[shapeid] !== <span class="hljs-literal">undefined</span>) ? <span class="hljs-keyword">this</span>.shapes[shapeid] : <span class="hljs-literal">undefined</span>;
        },

        <span class="hljs-attr">getCurrentRegionFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> currentRegion = <span class="hljs-keyword">this</span>.currentRegion;
            <span class="hljs-keyword">return</span> {
                <span class="hljs-attr">isNull</span>: <span class="hljs-keyword">this</span>.values[currentRegion] === <span class="hljs-literal">undefined</span>,
                <span class="hljs-attr">value</span>: <span class="hljs-keyword">this</span>.values[currentRegion],
                <span class="hljs-attr">percent</span>: <span class="hljs-keyword">this</span>.values[currentRegion] / <span class="hljs-keyword">this</span>.total * <span class="hljs-number">100</span>,
                <span class="hljs-attr">color</span>: <span class="hljs-keyword">this</span>.options.get(<span class="hljs-string">'sliceColors'</span>)[currentRegion % <span class="hljs-keyword">this</span>.options.get(<span class="hljs-string">'sliceColors'</span>).length],
                <span class="hljs-attr">offset</span>: currentRegion
            };
        },

        <span class="hljs-attr">changeHighlight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">highlight</span>) </span>{
            <span class="hljs-keyword">var</span> currentRegion = <span class="hljs-keyword">this</span>.currentRegion,
                 newslice = <span class="hljs-keyword">this</span>.renderSlice(currentRegion, highlight),
                 shapeid = <span class="hljs-keyword">this</span>.valueShapes[currentRegion];
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.shapes[shapeid];
            <span class="hljs-keyword">this</span>.target.replaceWithShape(shapeid, newslice);
            <span class="hljs-keyword">this</span>.valueShapes[currentRegion] = newslice.id;
            <span class="hljs-keyword">this</span>.shapes[newslice.id] = currentRegion;
        },

        <span class="hljs-attr">renderSlice</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">valuenum, highlight</span>) </span>{
            <span class="hljs-keyword">var</span> target = <span class="hljs-keyword">this</span>.target,
                options = <span class="hljs-keyword">this</span>.options,
                radius = <span class="hljs-keyword">this</span>.radius,
                borderWidth = options.get(<span class="hljs-string">'borderWidth'</span>),
                offset = options.get(<span class="hljs-string">'offset'</span>),
                circle = <span class="hljs-number">2</span> * <span class="hljs-built_in">Math</span>.PI,
                values = <span class="hljs-keyword">this</span>.values,
                total = <span class="hljs-keyword">this</span>.total,
                next = offset ? (<span class="hljs-number">2</span>*<span class="hljs-built_in">Math</span>.PI)*(offset/<span class="hljs-number">360</span>) : <span class="hljs-number">0</span>,
                start, end, i, vlen, color;

            vlen = values.length;
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; vlen; i++) {
                start = next;
                end = next;
                <span class="hljs-keyword">if</span> (total &gt; <span class="hljs-number">0</span>) {  <span class="hljs-comment">// avoid divide by zero</span>
                    end = next + (circle * (values[i] / total));
                }
                <span class="hljs-keyword">if</span> (valuenum === i) {
                    color = options.get(<span class="hljs-string">'sliceColors'</span>)[i % options.get(<span class="hljs-string">'sliceColors'</span>).length];
                    <span class="hljs-keyword">if</span> (highlight) {
                        color = <span class="hljs-keyword">this</span>.calcHighlightColor(color, options);
                    }

                    <span class="hljs-keyword">return</span> target.drawPieSlice(radius, radius, radius - borderWidth, start, end, <span class="hljs-literal">undefined</span>, color);
                }
                next = end;
            }
        },

        <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> target = <span class="hljs-keyword">this</span>.target,
                values = <span class="hljs-keyword">this</span>.values,
                options = <span class="hljs-keyword">this</span>.options,
                radius = <span class="hljs-keyword">this</span>.radius,
                borderWidth = options.get(<span class="hljs-string">'borderWidth'</span>),
                donutWidth = options.get(<span class="hljs-string">'donutWidth'</span>),
                shape, i;

            <span class="hljs-keyword">if</span> (!pie._super.render.call(<span class="hljs-keyword">this</span>)) {
                <span class="hljs-keyword">return</span>;
            }
            <span class="hljs-keyword">if</span> (borderWidth) {
                target.drawCircle(radius, radius, <span class="hljs-built_in">Math</span>.floor(radius - (borderWidth / <span class="hljs-number">2</span>)),
                    options.get(<span class="hljs-string">'borderColor'</span>), <span class="hljs-literal">undefined</span>, borderWidth).append();
            }
            <span class="hljs-keyword">for</span> (i = values.length; i--;) {
                <span class="hljs-keyword">if</span> (values[i]) { <span class="hljs-comment">// don't render zero values</span>
                    shape = <span class="hljs-keyword">this</span>.renderSlice(i).append();
                    <span class="hljs-keyword">this</span>.valueShapes[i] = shape.id; <span class="hljs-comment">// store just the shapeid</span>
                    <span class="hljs-keyword">this</span>.shapes[shape.id] = i;
                }
            }
            <span class="hljs-keyword">if</span> (donutWidth) {
                target.drawCircle(radius, radius, radius - donutWidth, options.get(<span class="hljs-string">'donutColor'</span>), 
                    options.get(<span class="hljs-string">'donutColor'</span>), <span class="hljs-number">0</span>).append();
            }
            target.render();
        }
    });

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-59" id="section-59"></a>
</div>
<div class="dox">
<div class="summary">
<p>Box plots</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">    $.fn.sparkline.box = box = createClass($.fn.sparkline._base, {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'box'</span>,

        <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el, values, options, width, height</span>) </span>{
            box._super.init.call(<span class="hljs-keyword">this</span>, el, values, options, width, height);
            <span class="hljs-keyword">this</span>.values = $.map(values, <span class="hljs-built_in">Number</span>);
            <span class="hljs-keyword">this</span>.width = options.get(<span class="hljs-string">'width'</span>) === <span class="hljs-string">'auto'</span> ? <span class="hljs-string">'4.0em'</span> : width;
            <span class="hljs-keyword">this</span>.initTarget();
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.values.length) {
                <span class="hljs-keyword">this</span>.disabled = <span class="hljs-number">1</span>;
            }
        },

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-60" id="section-60"></a>
</div>
<div class="dox">
<div class="summary">
<p>Simulate a single region</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">        getRegion: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
        },

        <span class="hljs-attr">getCurrentRegionFields</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> result = [
                { <span class="hljs-attr">field</span>: <span class="hljs-string">'lq'</span>, <span class="hljs-attr">value</span>: <span class="hljs-keyword">this</span>.quartiles[<span class="hljs-number">0</span>] },
                { <span class="hljs-attr">field</span>: <span class="hljs-string">'med'</span>, <span class="hljs-attr">value</span>: <span class="hljs-keyword">this</span>.quartiles[<span class="hljs-number">1</span>] },
                { <span class="hljs-attr">field</span>: <span class="hljs-string">'uq'</span>, <span class="hljs-attr">value</span>: <span class="hljs-keyword">this</span>.quartiles[<span class="hljs-number">2</span>] }
            ];
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.loutlier !== <span class="hljs-literal">undefined</span>) {
                result.push({ <span class="hljs-attr">field</span>: <span class="hljs-string">'lo'</span>, <span class="hljs-attr">value</span>: <span class="hljs-keyword">this</span>.loutlier});
            }
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.routlier !== <span class="hljs-literal">undefined</span>) {
                result.push({ <span class="hljs-attr">field</span>: <span class="hljs-string">'ro'</span>, <span class="hljs-attr">value</span>: <span class="hljs-keyword">this</span>.routlier});
            }
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.lwhisker !== <span class="hljs-literal">undefined</span>) {
                result.push({ <span class="hljs-attr">field</span>: <span class="hljs-string">'lw'</span>, <span class="hljs-attr">value</span>: <span class="hljs-keyword">this</span>.lwhisker});
            }
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.rwhisker !== <span class="hljs-literal">undefined</span>) {
                result.push({ <span class="hljs-attr">field</span>: <span class="hljs-string">'rw'</span>, <span class="hljs-attr">value</span>: <span class="hljs-keyword">this</span>.rwhisker});
            }
            <span class="hljs-keyword">return</span> result;
        },

        <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> target = <span class="hljs-keyword">this</span>.target,
                values = <span class="hljs-keyword">this</span>.values,
                vlen = values.length,
                options = <span class="hljs-keyword">this</span>.options,
                canvasWidth = <span class="hljs-keyword">this</span>.canvasWidth,
                canvasHeight = <span class="hljs-keyword">this</span>.canvasHeight,
                minValue = options.get(<span class="hljs-string">'chartRangeMin'</span>) === <span class="hljs-literal">undefined</span> ? <span class="hljs-built_in">Math</span>.min.apply(<span class="hljs-built_in">Math</span>, values) : options.get(<span class="hljs-string">'chartRangeMin'</span>),
                maxValue = options.get(<span class="hljs-string">'chartRangeMax'</span>) === <span class="hljs-literal">undefined</span> ? <span class="hljs-built_in">Math</span>.max.apply(<span class="hljs-built_in">Math</span>, values) : options.get(<span class="hljs-string">'chartRangeMax'</span>),
                canvasLeft = <span class="hljs-number">0</span>,
                lwhisker, loutlier, iqr, q1, q2, q3, rwhisker, routlier, i,
                size, unitSize;

            <span class="hljs-keyword">if</span> (!box._super.render.call(<span class="hljs-keyword">this</span>)) {
                <span class="hljs-keyword">return</span>;
            }

            <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'raw'</span>)) {
                <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'showOutliers'</span>) &amp;&amp; values.length &gt; <span class="hljs-number">5</span>) {
                    loutlier = values[<span class="hljs-number">0</span>];
                    lwhisker = values[<span class="hljs-number">1</span>];
                    q1 = values[<span class="hljs-number">2</span>];
                    q2 = values[<span class="hljs-number">3</span>];
                    q3 = values[<span class="hljs-number">4</span>];
                    rwhisker = values[<span class="hljs-number">5</span>];
                    routlier = values[<span class="hljs-number">6</span>];
                } <span class="hljs-keyword">else</span> {
                    lwhisker = values[<span class="hljs-number">0</span>];
                    q1 = values[<span class="hljs-number">1</span>];
                    q2 = values[<span class="hljs-number">2</span>];
                    q3 = values[<span class="hljs-number">3</span>];
                    rwhisker = values[<span class="hljs-number">4</span>];
                }
            } <span class="hljs-keyword">else</span> {
                values.sort(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a, b</span>) </span>{ <span class="hljs-keyword">return</span> a - b; });
                q1 = quartile(values, <span class="hljs-number">1</span>);
                q2 = quartile(values, <span class="hljs-number">2</span>);
                q3 = quartile(values, <span class="hljs-number">3</span>);
                iqr = q3 - q1;
                <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'showOutliers'</span>)) {
                    lwhisker = rwhisker = <span class="hljs-literal">undefined</span>;
                    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; vlen; i++) {
                        <span class="hljs-keyword">if</span> (lwhisker === <span class="hljs-literal">undefined</span> &amp;&amp; values[i] &gt; q1 - (iqr * options.get(<span class="hljs-string">'outlierIQR'</span>))) {
                            lwhisker = values[i];
                        }
                        <span class="hljs-keyword">if</span> (values[i] &lt; q3 + (iqr * options.get(<span class="hljs-string">'outlierIQR'</span>))) {
                            rwhisker = values[i];
                        }
                    }
                    loutlier = values[<span class="hljs-number">0</span>];
                    routlier = values[vlen - <span class="hljs-number">1</span>];
                } <span class="hljs-keyword">else</span> {
                    lwhisker = values[<span class="hljs-number">0</span>];
                    rwhisker = values[vlen - <span class="hljs-number">1</span>];
                }
            }
            <span class="hljs-keyword">this</span>.quartiles = [q1, q2, q3];
            <span class="hljs-keyword">this</span>.lwhisker = lwhisker;
            <span class="hljs-keyword">this</span>.rwhisker = rwhisker;
            <span class="hljs-keyword">this</span>.loutlier = loutlier;
            <span class="hljs-keyword">this</span>.routlier = routlier;

            unitSize = canvasWidth / (maxValue - minValue + <span class="hljs-number">1</span>);
            <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'showOutliers'</span>)) {
                canvasLeft = <span class="hljs-built_in">Math</span>.ceil(options.get(<span class="hljs-string">'spotRadius'</span>));
                canvasWidth -= <span class="hljs-number">2</span> * <span class="hljs-built_in">Math</span>.ceil(options.get(<span class="hljs-string">'spotRadius'</span>));
                unitSize = canvasWidth / (maxValue - minValue + <span class="hljs-number">1</span>);
                <span class="hljs-keyword">if</span> (loutlier &lt; lwhisker) {
                    target.drawCircle((loutlier - minValue) * unitSize + canvasLeft,
                        canvasHeight / <span class="hljs-number">2</span>,
                        options.get(<span class="hljs-string">'spotRadius'</span>),
                        options.get(<span class="hljs-string">'outlierLineColor'</span>),
                        options.get(<span class="hljs-string">'outlierFillColor'</span>)).append();
                }
                <span class="hljs-keyword">if</span> (routlier &gt; rwhisker) {
                    target.drawCircle((routlier - minValue) * unitSize + canvasLeft,
                        canvasHeight / <span class="hljs-number">2</span>,
                        options.get(<span class="hljs-string">'spotRadius'</span>),
                        options.get(<span class="hljs-string">'outlierLineColor'</span>),
                        options.get(<span class="hljs-string">'outlierFillColor'</span>)).append();
                }
            }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-61" id="section-61"></a>
</div>
<p>box</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            target.drawRect(
                <span class="hljs-built_in">Math</span>.round((q1 - minValue) * unitSize + canvasLeft),
                <span class="hljs-built_in">Math</span>.round(canvasHeight * <span class="hljs-number">0.1</span>),
                <span class="hljs-built_in">Math</span>.round((q3 - q1) * unitSize),
                <span class="hljs-built_in">Math</span>.round(canvasHeight * <span class="hljs-number">0.8</span>),
                options.get(<span class="hljs-string">'boxLineColor'</span>),
                options.get(<span class="hljs-string">'boxFillColor'</span>)).append();
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-62" id="section-62"></a>
</div>
<p>left whisker</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            target.drawLine(
                <span class="hljs-built_in">Math</span>.round((lwhisker - minValue) * unitSize + canvasLeft),
                <span class="hljs-built_in">Math</span>.round(canvasHeight / <span class="hljs-number">2</span>),
                <span class="hljs-built_in">Math</span>.round((q1 - minValue) * unitSize + canvasLeft),
                <span class="hljs-built_in">Math</span>.round(canvasHeight / <span class="hljs-number">2</span>),
                options.get(<span class="hljs-string">'lineColor'</span>)).append();
            target.drawLine(
                <span class="hljs-built_in">Math</span>.round((lwhisker - minValue) * unitSize + canvasLeft),
                <span class="hljs-built_in">Math</span>.round(canvasHeight / <span class="hljs-number">4</span>),
                <span class="hljs-built_in">Math</span>.round((lwhisker - minValue) * unitSize + canvasLeft),
                <span class="hljs-built_in">Math</span>.round(canvasHeight - canvasHeight / <span class="hljs-number">4</span>),
                options.get(<span class="hljs-string">'whiskerColor'</span>)).append();
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-63" id="section-63"></a>
</div>
<p>right whisker</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            target.drawLine(<span class="hljs-built_in">Math</span>.round((rwhisker - minValue) * unitSize + canvasLeft),
                <span class="hljs-built_in">Math</span>.round(canvasHeight / <span class="hljs-number">2</span>),
                <span class="hljs-built_in">Math</span>.round((q3 - minValue) * unitSize + canvasLeft),
                <span class="hljs-built_in">Math</span>.round(canvasHeight / <span class="hljs-number">2</span>),
                options.get(<span class="hljs-string">'lineColor'</span>)).append();
            target.drawLine(
                <span class="hljs-built_in">Math</span>.round((rwhisker - minValue) * unitSize + canvasLeft),
                <span class="hljs-built_in">Math</span>.round(canvasHeight / <span class="hljs-number">4</span>),
                <span class="hljs-built_in">Math</span>.round((rwhisker - minValue) * unitSize + canvasLeft),
                <span class="hljs-built_in">Math</span>.round(canvasHeight - canvasHeight / <span class="hljs-number">4</span>),
                options.get(<span class="hljs-string">'whiskerColor'</span>)).append();
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-64" id="section-64"></a>
</div>
<p>median line</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            target.drawLine(
                <span class="hljs-built_in">Math</span>.round((q2 - minValue) * unitSize + canvasLeft),
                <span class="hljs-built_in">Math</span>.round(canvasHeight * <span class="hljs-number">0.1</span>),
                <span class="hljs-built_in">Math</span>.round((q2 - minValue) * unitSize + canvasLeft),
                <span class="hljs-built_in">Math</span>.round(canvasHeight * <span class="hljs-number">0.9</span>),
                options.get(<span class="hljs-string">'medianColor'</span>)).append();
            <span class="hljs-keyword">if</span> (options.get(<span class="hljs-string">'target'</span>)) {
                size = <span class="hljs-built_in">Math</span>.ceil(options.get(<span class="hljs-string">'spotRadius'</span>));
                target.drawLine(
                    <span class="hljs-built_in">Math</span>.round((options.get(<span class="hljs-string">'target'</span>) - minValue) * unitSize + canvasLeft),
                    <span class="hljs-built_in">Math</span>.round((canvasHeight / <span class="hljs-number">2</span>) - size),
                    <span class="hljs-built_in">Math</span>.round((options.get(<span class="hljs-string">'target'</span>) - minValue) * unitSize + canvasLeft),
                    <span class="hljs-built_in">Math</span>.round((canvasHeight / <span class="hljs-number">2</span>) + size),
                    options.get(<span class="hljs-string">'targetColor'</span>)).append();
                target.drawLine(
                    <span class="hljs-built_in">Math</span>.round((options.get(<span class="hljs-string">'target'</span>) - minValue) * unitSize + canvasLeft - size),
                    <span class="hljs-built_in">Math</span>.round(canvasHeight / <span class="hljs-number">2</span>),
                    <span class="hljs-built_in">Math</span>.round((options.get(<span class="hljs-string">'target'</span>) - minValue) * unitSize + canvasLeft + size),
                    <span class="hljs-built_in">Math</span>.round(canvasHeight / <span class="hljs-number">2</span>),
                    options.get(<span class="hljs-string">'targetColor'</span>)).append();
            }
            target.render();
        }
    });

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-65" id="section-65"></a>
</div>
<p>Setup a very simple &quot;virtual canvas&quot; to make drawing the few shapes we need easier
This is accessible as $(foo).simpledraw()</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
    VShape = createClass({
        <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">target, id, type, args</span>) </span>{
            <span class="hljs-keyword">this</span>.target = target;
            <span class="hljs-keyword">this</span>.id = id;
            <span class="hljs-keyword">this</span>.type = type;
            <span class="hljs-keyword">this</span>.args = args;
        },
        <span class="hljs-attr">append</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">this</span>.target.appendShape(<span class="hljs-keyword">this</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        }
    });

    VCanvas_base = createClass({
        <span class="hljs-attr">_pxregex</span>: <span class="hljs-regexp">/(\d+)(px)?\s*$/i</span>,

        <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">width, height, target</span>) </span>{
            <span class="hljs-keyword">if</span> (!width) {
                <span class="hljs-keyword">return</span>;
            }
            <span class="hljs-keyword">this</span>.width = width;
            <span class="hljs-keyword">this</span>.height = height;
            <span class="hljs-keyword">this</span>.target = target;
            <span class="hljs-keyword">this</span>.lastShapeId = <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">if</span> (target[<span class="hljs-number">0</span>]) {
                target = target[<span class="hljs-number">0</span>];
            }
            $.data(target, <span class="hljs-string">'_jqs_vcanvas'</span>, <span class="hljs-keyword">this</span>);
        },

        <span class="hljs-attr">drawLine</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">x1, y1, x2, y2, lineColor, lineWidth</span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.drawShape([[x1, y1], [x2, y2]], lineColor, lineWidth);
        },

        <span class="hljs-attr">drawShape</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">path, lineColor, fillColor, lineWidth</span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._genShape(<span class="hljs-string">'Shape'</span>, [path, lineColor, fillColor, lineWidth]);
        },

        <span class="hljs-attr">drawCircle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">x, y, radius, lineColor, fillColor, lineWidth</span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._genShape(<span class="hljs-string">'Circle'</span>, [x, y, radius, lineColor, fillColor, lineWidth]);
        },

        <span class="hljs-attr">drawPieSlice</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">x, y, radius, startAngle, endAngle, lineColor, fillColor</span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._genShape(<span class="hljs-string">'PieSlice'</span>, [x, y, radius, startAngle, endAngle, lineColor, fillColor]);
        },

        <span class="hljs-attr">drawRect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">x, y, width, height, lineColor, fillColor</span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._genShape(<span class="hljs-string">'Rect'</span>, [x, y, width, height, lineColor, fillColor]);
        },

        <span class="hljs-attr">getElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.canvas;
        },

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-66" id="section-66"></a>
</div>
<div class="dox">
<div class="summary">
<p>Return the most recently inserted shape id</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">        getLastShapeId: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.lastShapeId;
        },

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-67" id="section-67"></a>
</div>
<div class="dox">
<div class="summary">
<p>Clear and reset the canvas</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">        reset: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            alert(<span class="hljs-string">'reset not implemented'</span>);
        },

        <span class="hljs-attr">_insert</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el, target</span>) </span>{
            $(target).html(el);
        },

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-68" id="section-68"></a>
</div>
<div class="dox">
<div class="summary">
<p>Calculate the pixel dimensions of the canvas</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">        _calculatePixelDims: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">width, height, canvas</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-69" id="section-69"></a>
</div>
<p>XXX This should probably be a configurable option</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">var</span> match;
            match = <span class="hljs-keyword">this</span>._pxregex.exec(height);
            <span class="hljs-keyword">if</span> (match) {
                <span class="hljs-keyword">this</span>.pixelHeight = match[<span class="hljs-number">1</span>];
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">this</span>.pixelHeight = $(canvas).height();
            }
            match = <span class="hljs-keyword">this</span>._pxregex.exec(width);
            <span class="hljs-keyword">if</span> (match) {
                <span class="hljs-keyword">this</span>.pixelWidth = match[<span class="hljs-number">1</span>];
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">this</span>.pixelWidth = $(canvas).width();
            }
        },

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-70" id="section-70"></a>
</div>
<div class="dox">
<div class="summary">
<p>Generate a shape object and id for later rendering</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">        _genShape: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shapetype, shapeargs</span>) </span>{
            <span class="hljs-keyword">var</span> id = shapeCount++;
            shapeargs.unshift(id);
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> VShape(<span class="hljs-keyword">this</span>, id, shapetype, shapeargs);
        },

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-71" id="section-71"></a>
</div>
<div class="dox">
<div class="summary">
<p>Add a shape to the end of the render queue</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">        appendShape: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shape</span>) </span>{
            alert(<span class="hljs-string">'appendShape not implemented'</span>);
        },

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-72" id="section-72"></a>
</div>
<div class="dox">
<div class="summary">
<p>Replace one shape with another</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">        replaceWithShape: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shapeid, shape</span>) </span>{
            alert(<span class="hljs-string">'replaceWithShape not implemented'</span>);
        },

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-73" id="section-73"></a>
</div>
<div class="dox">
<div class="summary">
<p>Insert one shape after another in the render queue</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">        insertAfterShape: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shapeid, shape</span>) </span>{
            alert(<span class="hljs-string">'insertAfterShape not implemented'</span>);
        },

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-74" id="section-74"></a>
</div>
<div class="dox">
<div class="summary">
<p>Remove a shape from the queue</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">        removeShapeId: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shapeid</span>) </span>{
            alert(<span class="hljs-string">'removeShapeId not implemented'</span>);
        },

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-75" id="section-75"></a>
</div>
<div class="dox">
<div class="summary">
<p>Find a shape at the specified x/y co-ordinates</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">        getShapeAt: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el, x, y</span>) </span>{
            alert(<span class="hljs-string">'getShapeAt not implemented'</span>);
        },

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-76" id="section-76"></a>
</div>
<div class="dox">
<div class="summary">
<p>Render all queued shapes onto the canvas</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">        render: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            alert(<span class="hljs-string">'render not implemented'</span>);
        }
    });

    VCanvas_canvas = createClass(VCanvas_base, {
        <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">width, height, target, interact</span>) </span>{
            VCanvas_canvas._super.init.call(<span class="hljs-keyword">this</span>, width, height, target);
            <span class="hljs-keyword">this</span>.canvas = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'canvas'</span>);
            <span class="hljs-keyword">if</span> (target[<span class="hljs-number">0</span>]) {
                target = target[<span class="hljs-number">0</span>];
            }
            $.data(target, <span class="hljs-string">'_jqs_vcanvas'</span>, <span class="hljs-keyword">this</span>);
            $(<span class="hljs-keyword">this</span>.canvas).css({ <span class="hljs-attr">display</span>: <span class="hljs-string">'inline-block'</span>, <span class="hljs-attr">width</span>: width, <span class="hljs-attr">height</span>: height, <span class="hljs-attr">verticalAlign</span>: <span class="hljs-string">'top'</span> });
            <span class="hljs-keyword">this</span>._insert(<span class="hljs-keyword">this</span>.canvas, target);
            <span class="hljs-keyword">this</span>._calculatePixelDims(width, height, <span class="hljs-keyword">this</span>.canvas);
            <span class="hljs-keyword">this</span>.canvas.width = <span class="hljs-keyword">this</span>.pixelWidth;
            <span class="hljs-keyword">this</span>.canvas.height = <span class="hljs-keyword">this</span>.pixelHeight;
            <span class="hljs-keyword">this</span>.interact = interact;
            <span class="hljs-keyword">this</span>.shapes = {};
            <span class="hljs-keyword">this</span>.shapeseq = [];
            <span class="hljs-keyword">this</span>.currentTargetShapeId = <span class="hljs-literal">undefined</span>;
            $(<span class="hljs-keyword">this</span>.canvas).css({<span class="hljs-attr">width</span>: <span class="hljs-keyword">this</span>.pixelWidth, <span class="hljs-attr">height</span>: <span class="hljs-keyword">this</span>.pixelHeight});
        },

        <span class="hljs-attr">_getContext</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">lineColor, fillColor, lineWidth</span>) </span>{
            <span class="hljs-keyword">var</span> context = <span class="hljs-keyword">this</span>.canvas.getContext(<span class="hljs-string">'2d'</span>);
            <span class="hljs-keyword">if</span> (lineColor !== <span class="hljs-literal">undefined</span>) {
                context.strokeStyle = lineColor;
            }
            context.lineWidth = lineWidth === <span class="hljs-literal">undefined</span> ? <span class="hljs-number">1</span> : lineWidth;
            <span class="hljs-keyword">if</span> (fillColor !== <span class="hljs-literal">undefined</span>) {
                context.fillStyle = fillColor;
            }
            <span class="hljs-keyword">return</span> context;
        },

        <span class="hljs-attr">reset</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> context = <span class="hljs-keyword">this</span>._getContext();
            context.clearRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.pixelWidth, <span class="hljs-keyword">this</span>.pixelHeight);
            <span class="hljs-keyword">this</span>.shapes = {};
            <span class="hljs-keyword">this</span>.shapeseq = [];
            <span class="hljs-keyword">this</span>.currentTargetShapeId = <span class="hljs-literal">undefined</span>;
        },

        <span class="hljs-attr">_drawShape</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shapeid, path, lineColor, fillColor, lineWidth</span>) </span>{
            <span class="hljs-keyword">var</span> context = <span class="hljs-keyword">this</span>._getContext(lineColor, fillColor, lineWidth),
                i, plen;
            context.beginPath();
            context.moveTo(path[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] + <span class="hljs-number">0.5</span>, path[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] + <span class="hljs-number">0.5</span>);
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">1</span>, plen = path.length; i &lt; plen; i++) {
                context.lineTo(path[i][<span class="hljs-number">0</span>] + <span class="hljs-number">0.5</span>, path[i][<span class="hljs-number">1</span>] + <span class="hljs-number">0.5</span>); <span class="hljs-comment">// the 0.5 offset gives us crisp pixel-width lines</span>
            }
            <span class="hljs-keyword">if</span> (lineColor !== <span class="hljs-literal">undefined</span>) {
                context.stroke();
            }
            <span class="hljs-keyword">if</span> (fillColor !== <span class="hljs-literal">undefined</span>) {
                context.fill();
            }
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.targetX !== <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-keyword">this</span>.targetY !== <span class="hljs-literal">undefined</span> &amp;&amp;
                context.isPointInPath(<span class="hljs-keyword">this</span>.targetX, <span class="hljs-keyword">this</span>.targetY)) {
                <span class="hljs-keyword">this</span>.currentTargetShapeId = shapeid;
            }
        },

        <span class="hljs-attr">_drawCircle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shapeid, x, y, radius, lineColor, fillColor, lineWidth</span>) </span>{
            <span class="hljs-keyword">var</span> context = <span class="hljs-keyword">this</span>._getContext(lineColor, fillColor, lineWidth);
            context.beginPath();
            context.arc(x, y, radius, <span class="hljs-number">0</span>, <span class="hljs-number">2</span> * <span class="hljs-built_in">Math</span>.PI, <span class="hljs-literal">false</span>);
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.targetX !== <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-keyword">this</span>.targetY !== <span class="hljs-literal">undefined</span> &amp;&amp;
                context.isPointInPath(<span class="hljs-keyword">this</span>.targetX, <span class="hljs-keyword">this</span>.targetY)) {
                <span class="hljs-keyword">this</span>.currentTargetShapeId = shapeid;
            }
            <span class="hljs-keyword">if</span> (lineColor !== <span class="hljs-literal">undefined</span>) {
                context.stroke();
            }
            <span class="hljs-keyword">if</span> (fillColor !== <span class="hljs-literal">undefined</span>) {
                context.fill();
            }
        },

        <span class="hljs-attr">_drawPieSlice</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shapeid, x, y, radius, startAngle, endAngle, lineColor, fillColor</span>) </span>{
            <span class="hljs-keyword">var</span> context = <span class="hljs-keyword">this</span>._getContext(lineColor, fillColor);
            context.beginPath();
            context.moveTo(x, y);
            context.arc(x, y, radius, startAngle, endAngle, <span class="hljs-literal">false</span>);
            context.lineTo(x, y);
            context.closePath();
            <span class="hljs-keyword">if</span> (lineColor !== <span class="hljs-literal">undefined</span>) {
                context.stroke();
            }
            <span class="hljs-keyword">if</span> (fillColor) {
                context.fill();
            }
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.targetX !== <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-keyword">this</span>.targetY !== <span class="hljs-literal">undefined</span> &amp;&amp;
                context.isPointInPath(<span class="hljs-keyword">this</span>.targetX, <span class="hljs-keyword">this</span>.targetY)) {
                <span class="hljs-keyword">this</span>.currentTargetShapeId = shapeid;
            }
        },

        <span class="hljs-attr">_drawRect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shapeid, x, y, width, height, lineColor, fillColor</span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._drawShape(shapeid, [[x, y], [x + width, y], [x + width, y + height], [x, y + height], [x, y]], lineColor, fillColor);
        },

        <span class="hljs-attr">appendShape</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shape</span>) </span>{
            <span class="hljs-keyword">this</span>.shapes[shape.id] = shape;
            <span class="hljs-keyword">this</span>.shapeseq.push(shape.id);
            <span class="hljs-keyword">this</span>.lastShapeId = shape.id;
            <span class="hljs-keyword">return</span> shape.id;
        },

        <span class="hljs-attr">replaceWithShape</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shapeid, shape</span>) </span>{
            <span class="hljs-keyword">var</span> shapeseq = <span class="hljs-keyword">this</span>.shapeseq,
                i;
            <span class="hljs-keyword">this</span>.shapes[shape.id] = shape;
            <span class="hljs-keyword">for</span> (i = shapeseq.length; i--;) {
                <span class="hljs-keyword">if</span> (shapeseq[i] == shapeid) {
                    shapeseq[i] = shape.id;
                }
            }
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.shapes[shapeid];
        },

        <span class="hljs-attr">replaceWithShapes</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shapeids, shapes</span>) </span>{
            <span class="hljs-keyword">var</span> shapeseq = <span class="hljs-keyword">this</span>.shapeseq,
                shapemap = {},
                sid, i, first;

            <span class="hljs-keyword">for</span> (i = shapeids.length; i--;) {
                shapemap[shapeids[i]] = <span class="hljs-literal">true</span>;
            }
            <span class="hljs-keyword">for</span> (i = shapeseq.length; i--;) {
                sid = shapeseq[i];
                <span class="hljs-keyword">if</span> (shapemap[sid]) {
                    shapeseq.splice(i, <span class="hljs-number">1</span>);
                    <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.shapes[sid];
                    first = i;
                }
            }
            <span class="hljs-keyword">for</span> (i = shapes.length; i--;) {
                shapeseq.splice(first, <span class="hljs-number">0</span>, shapes[i].id);
                <span class="hljs-keyword">this</span>.shapes[shapes[i].id] = shapes[i];
            }

        },

        <span class="hljs-attr">insertAfterShape</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shapeid, shape</span>) </span>{
            <span class="hljs-keyword">var</span> shapeseq = <span class="hljs-keyword">this</span>.shapeseq,
                i;
            <span class="hljs-keyword">for</span> (i = shapeseq.length; i--;) {
                <span class="hljs-keyword">if</span> (shapeseq[i] === shapeid) {
                    shapeseq.splice(i + <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, shape.id);
                    <span class="hljs-keyword">this</span>.shapes[shape.id] = shape;
                    <span class="hljs-keyword">return</span>;
                }
            }
        },

        <span class="hljs-attr">removeShapeId</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shapeid</span>) </span>{
            <span class="hljs-keyword">var</span> shapeseq = <span class="hljs-keyword">this</span>.shapeseq,
                i;
            <span class="hljs-keyword">for</span> (i = shapeseq.length; i--;) {
                <span class="hljs-keyword">if</span> (shapeseq[i] === shapeid) {
                    shapeseq.splice(i, <span class="hljs-number">1</span>);
                    <span class="hljs-keyword">break</span>;
                }
            }
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.shapes[shapeid];
        },

        <span class="hljs-attr">getShapeAt</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el, x, y</span>) </span>{
            <span class="hljs-keyword">this</span>.targetX = x;
            <span class="hljs-keyword">this</span>.targetY = y;
            <span class="hljs-keyword">this</span>.render();
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.currentTargetShapeId;
        },

        <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> shapeseq = <span class="hljs-keyword">this</span>.shapeseq,
                shapes = <span class="hljs-keyword">this</span>.shapes,
                shapeCount = shapeseq.length,
                context = <span class="hljs-keyword">this</span>._getContext(),
                shapeid, shape, i;
            context.clearRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.pixelWidth, <span class="hljs-keyword">this</span>.pixelHeight);
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; shapeCount; i++) {
                shapeid = shapeseq[i];
                shape = shapes[shapeid];
                <span class="hljs-keyword">this</span>[<span class="hljs-string">'_draw'</span> + shape.type].apply(<span class="hljs-keyword">this</span>, shape.args);
            }
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.interact) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-77" id="section-77"></a>
</div>
<p>not interactive so no need to keep the shapes array</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                <span class="hljs-keyword">this</span>.shapes = {};
                <span class="hljs-keyword">this</span>.shapeseq = [];
            }
        }

    });

    VCanvas_vml = createClass(VCanvas_base, {
        <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">width, height, target</span>) </span>{
            <span class="hljs-keyword">var</span> groupel;
            VCanvas_vml._super.init.call(<span class="hljs-keyword">this</span>, width, height, target);
            <span class="hljs-keyword">if</span> (target[<span class="hljs-number">0</span>]) {
                target = target[<span class="hljs-number">0</span>];
            }
            $.data(target, <span class="hljs-string">'_jqs_vcanvas'</span>, <span class="hljs-keyword">this</span>);
            <span class="hljs-keyword">this</span>.canvas = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'span'</span>);
            $(<span class="hljs-keyword">this</span>.canvas).css({ <span class="hljs-attr">display</span>: <span class="hljs-string">'inline-block'</span>, <span class="hljs-attr">position</span>: <span class="hljs-string">'relative'</span>, <span class="hljs-attr">overflow</span>: <span class="hljs-string">'hidden'</span>, <span class="hljs-attr">width</span>: width, <span class="hljs-attr">height</span>: height, <span class="hljs-attr">margin</span>: <span class="hljs-string">'0px'</span>, <span class="hljs-attr">padding</span>: <span class="hljs-string">'0px'</span>, <span class="hljs-attr">verticalAlign</span>: <span class="hljs-string">'top'</span>});
            <span class="hljs-keyword">this</span>._insert(<span class="hljs-keyword">this</span>.canvas, target);
            <span class="hljs-keyword">this</span>._calculatePixelDims(width, height, <span class="hljs-keyword">this</span>.canvas);
            <span class="hljs-keyword">this</span>.canvas.width = <span class="hljs-keyword">this</span>.pixelWidth;
            <span class="hljs-keyword">this</span>.canvas.height = <span class="hljs-keyword">this</span>.pixelHeight;
            groupel = <span class="hljs-string">'&lt;v:group coordorigin="0 0" coordsize="'</span> + <span class="hljs-keyword">this</span>.pixelWidth + <span class="hljs-string">' '</span> + <span class="hljs-keyword">this</span>.pixelHeight + <span class="hljs-string">'"'</span> +
                    <span class="hljs-string">' style="position:absolute;top:0;left:0;width:'</span> + <span class="hljs-keyword">this</span>.pixelWidth + <span class="hljs-string">'px;height='</span> + <span class="hljs-keyword">this</span>.pixelHeight + <span class="hljs-string">'px;"&gt;&lt;/v:group&gt;'</span>;
            <span class="hljs-keyword">this</span>.canvas.insertAdjacentHTML(<span class="hljs-string">'beforeEnd'</span>, groupel);
            <span class="hljs-keyword">this</span>.group = $(<span class="hljs-keyword">this</span>.canvas).children()[<span class="hljs-number">0</span>];
            <span class="hljs-keyword">this</span>.rendered = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">this</span>.prerender = <span class="hljs-string">''</span>;
        },

        <span class="hljs-attr">_drawShape</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shapeid, path, lineColor, fillColor, lineWidth</span>) </span>{
            <span class="hljs-keyword">var</span> vpath = [],
                initial, stroke, fill, closed, vel, plen, i;
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, plen = path.length; i &lt; plen; i++) {
                vpath[i] = <span class="hljs-string">''</span> + (path[i][<span class="hljs-number">0</span>]) + <span class="hljs-string">','</span> + (path[i][<span class="hljs-number">1</span>]);
            }
            initial = vpath.splice(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>);
            lineWidth = lineWidth === <span class="hljs-literal">undefined</span> ? <span class="hljs-number">1</span> : lineWidth;
            stroke = lineColor === <span class="hljs-literal">undefined</span> ? <span class="hljs-string">' stroked="false" '</span> : <span class="hljs-string">' strokeWeight="'</span> + lineWidth + <span class="hljs-string">'px" strokeColor="'</span> + lineColor + <span class="hljs-string">'" '</span>;
            fill = fillColor === <span class="hljs-literal">undefined</span> ? <span class="hljs-string">' filled="false"'</span> : <span class="hljs-string">' fillColor="'</span> + fillColor + <span class="hljs-string">'" filled="true" '</span>;
            closed = vpath[<span class="hljs-number">0</span>] === vpath[vpath.length - <span class="hljs-number">1</span>] ? <span class="hljs-string">'x '</span> : <span class="hljs-string">''</span>;
            vel = <span class="hljs-string">'&lt;v:shape coordorigin="0 0" coordsize="'</span> + <span class="hljs-keyword">this</span>.pixelWidth + <span class="hljs-string">' '</span> + <span class="hljs-keyword">this</span>.pixelHeight + <span class="hljs-string">'" '</span> +
                 <span class="hljs-string">' id="jqsshape'</span> + shapeid + <span class="hljs-string">'" '</span> +
                 stroke +
                 fill +
                <span class="hljs-string">' style="position:absolute;left:0px;top:0px;height:'</span> + <span class="hljs-keyword">this</span>.pixelHeight + <span class="hljs-string">'px;width:'</span> + <span class="hljs-keyword">this</span>.pixelWidth + <span class="hljs-string">'px;padding:0px;margin:0px;" '</span> +
                <span class="hljs-string">' path="m '</span> + initial + <span class="hljs-string">' l '</span> + vpath.join(<span class="hljs-string">', '</span>) + <span class="hljs-string">' '</span> + closed + <span class="hljs-string">'e"&gt;'</span> +
                <span class="hljs-string">' &lt;/v:shape&gt;'</span>;
            <span class="hljs-keyword">return</span> vel;
        },

        <span class="hljs-attr">_drawCircle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shapeid, x, y, radius, lineColor, fillColor, lineWidth</span>) </span>{
            <span class="hljs-keyword">var</span> stroke, fill, vel;
            x -= radius;
            y -= radius;
            stroke = lineColor === <span class="hljs-literal">undefined</span> ? <span class="hljs-string">' stroked="false" '</span> : <span class="hljs-string">' strokeWeight="'</span> + lineWidth + <span class="hljs-string">'px" strokeColor="'</span> + lineColor + <span class="hljs-string">'" '</span>;
            fill = fillColor === <span class="hljs-literal">undefined</span> ? <span class="hljs-string">' filled="false"'</span> : <span class="hljs-string">' fillColor="'</span> + fillColor + <span class="hljs-string">'" filled="true" '</span>;
            vel = <span class="hljs-string">'&lt;v:oval '</span> +
                 <span class="hljs-string">' id="jqsshape'</span> + shapeid + <span class="hljs-string">'" '</span> +
                stroke +
                fill +
                <span class="hljs-string">' style="position:absolute;top:'</span> + y + <span class="hljs-string">'px; left:'</span> + x + <span class="hljs-string">'px; width:'</span> + (radius * <span class="hljs-number">2</span>) + <span class="hljs-string">'px; height:'</span> + (radius * <span class="hljs-number">2</span>) + <span class="hljs-string">'px"&gt;&lt;/v:oval&gt;'</span>;
            <span class="hljs-keyword">return</span> vel;

        },

        <span class="hljs-attr">_drawPieSlice</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shapeid, x, y, radius, startAngle, endAngle, lineColor, fillColor</span>) </span>{
            <span class="hljs-keyword">var</span> vpath, startx, starty, endx, endy, stroke, fill, vel;
            <span class="hljs-keyword">if</span> (startAngle === endAngle) {
                <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;  <span class="hljs-comment">// VML seems to have problem when start angle equals end angle.</span>
            }
            <span class="hljs-keyword">if</span> ((endAngle - startAngle) === (<span class="hljs-number">2</span> * <span class="hljs-built_in">Math</span>.PI)) {
                startAngle = <span class="hljs-number">0.0</span>;  <span class="hljs-comment">// VML seems to have a problem when drawing a full circle that doesn't start 0</span>
                endAngle = (<span class="hljs-number">2</span> * <span class="hljs-built_in">Math</span>.PI);
            }

            startx = x + <span class="hljs-built_in">Math</span>.round(<span class="hljs-built_in">Math</span>.cos(startAngle) * radius);
            starty = y + <span class="hljs-built_in">Math</span>.round(<span class="hljs-built_in">Math</span>.sin(startAngle) * radius);
            endx = x + <span class="hljs-built_in">Math</span>.round(<span class="hljs-built_in">Math</span>.cos(endAngle) * radius);
            endy = y + <span class="hljs-built_in">Math</span>.round(<span class="hljs-built_in">Math</span>.sin(endAngle) * radius);

            <span class="hljs-keyword">if</span> (startx === endx &amp;&amp; starty === endy) {
                <span class="hljs-keyword">if</span> ((endAngle - startAngle) &lt; <span class="hljs-built_in">Math</span>.PI) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-78" id="section-78"></a>
</div>
<p>Prevent very small slices from being mistaken as a whole pie</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                    <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
                }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-79" id="section-79"></a>
</div>
<p>essentially going to be the entire circle, so ignore startAngle</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                startx = endx = x + radius;
                starty = endy = y;
            }

            <span class="hljs-keyword">if</span> (startx === endx &amp;&amp; starty === endy &amp;&amp; (endAngle - startAngle) &lt; <span class="hljs-built_in">Math</span>.PI) {
                <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
            }

            vpath = [x - radius, y - radius, x + radius, y + radius, startx, starty, endx, endy];
            stroke = lineColor === <span class="hljs-literal">undefined</span> ? <span class="hljs-string">' stroked="false" '</span> : <span class="hljs-string">' strokeWeight="1px" strokeColor="'</span> + lineColor + <span class="hljs-string">'" '</span>;
            fill = fillColor === <span class="hljs-literal">undefined</span> ? <span class="hljs-string">' filled="false"'</span> : <span class="hljs-string">' fillColor="'</span> + fillColor + <span class="hljs-string">'" filled="true" '</span>;
            vel = <span class="hljs-string">'&lt;v:shape coordorigin="0 0" coordsize="'</span> + <span class="hljs-keyword">this</span>.pixelWidth + <span class="hljs-string">' '</span> + <span class="hljs-keyword">this</span>.pixelHeight + <span class="hljs-string">'" '</span> +
                 <span class="hljs-string">' id="jqsshape'</span> + shapeid + <span class="hljs-string">'" '</span> +
                 stroke +
                 fill +
                <span class="hljs-string">' style="position:absolute;left:0px;top:0px;height:'</span> + <span class="hljs-keyword">this</span>.pixelHeight + <span class="hljs-string">'px;width:'</span> + <span class="hljs-keyword">this</span>.pixelWidth + <span class="hljs-string">'px;padding:0px;margin:0px;" '</span> +
                <span class="hljs-string">' path="m '</span> + x + <span class="hljs-string">','</span> + y + <span class="hljs-string">' wa '</span> + vpath.join(<span class="hljs-string">', '</span>) + <span class="hljs-string">' x e"&gt;'</span> +
                <span class="hljs-string">' &lt;/v:shape&gt;'</span>;
            <span class="hljs-keyword">return</span> vel;
        },

        <span class="hljs-attr">_drawRect</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shapeid, x, y, width, height, lineColor, fillColor</span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._drawShape(shapeid, [[x, y], [x, y + height], [x + width, y + height], [x + width, y], [x, y]], lineColor, fillColor);
        },

        <span class="hljs-attr">reset</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">this</span>.group.innerHTML = <span class="hljs-string">''</span>;
        },

        <span class="hljs-attr">appendShape</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shape</span>) </span>{
            <span class="hljs-keyword">var</span> vel = <span class="hljs-keyword">this</span>[<span class="hljs-string">'_draw'</span> + shape.type].apply(<span class="hljs-keyword">this</span>, shape.args);
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.rendered) {
                <span class="hljs-keyword">this</span>.group.insertAdjacentHTML(<span class="hljs-string">'beforeEnd'</span>, vel);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">this</span>.prerender += vel;
            }
            <span class="hljs-keyword">this</span>.lastShapeId = shape.id;
            <span class="hljs-keyword">return</span> shape.id;
        },

        <span class="hljs-attr">replaceWithShape</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shapeid, shape</span>) </span>{
            <span class="hljs-keyword">var</span> existing = $(<span class="hljs-string">'#jqsshape'</span> + shapeid),
                vel = <span class="hljs-keyword">this</span>[<span class="hljs-string">'_draw'</span> + shape.type].apply(<span class="hljs-keyword">this</span>, shape.args);
            existing[<span class="hljs-number">0</span>].outerHTML = vel;
        },

        <span class="hljs-attr">replaceWithShapes</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shapeids, shapes</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-80" id="section-80"></a>
</div>
<p>replace the first shapeid with all the new shapes then toast the remaining old shapes</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">var</span> existing = $(<span class="hljs-string">'#jqsshape'</span> + shapeids[<span class="hljs-number">0</span>]),
                replace = <span class="hljs-string">''</span>,
                slen = shapes.length,
                i;
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; slen; i++) {
                replace += <span class="hljs-keyword">this</span>[<span class="hljs-string">'_draw'</span> + shapes[i].type].apply(<span class="hljs-keyword">this</span>, shapes[i].args);
            }
            existing[<span class="hljs-number">0</span>].outerHTML = replace;
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">1</span>; i &lt; shapeids.length; i++) {
                $(<span class="hljs-string">'#jqsshape'</span> + shapeids[i]).remove();
            }
        },

        <span class="hljs-attr">insertAfterShape</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shapeid, shape</span>) </span>{
            <span class="hljs-keyword">var</span> existing = $(<span class="hljs-string">'#jqsshape'</span> + shapeid),
                 vel = <span class="hljs-keyword">this</span>[<span class="hljs-string">'_draw'</span> + shape.type].apply(<span class="hljs-keyword">this</span>, shape.args);
            existing[<span class="hljs-number">0</span>].insertAdjacentHTML(<span class="hljs-string">'afterEnd'</span>, vel);
        },

        <span class="hljs-attr">removeShapeId</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">shapeid</span>) </span>{
            <span class="hljs-keyword">var</span> existing = $(<span class="hljs-string">'#jqsshape'</span> + shapeid);
            <span class="hljs-keyword">this</span>.group.removeChild(existing[<span class="hljs-number">0</span>]);
        },

        <span class="hljs-attr">getShapeAt</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el, x, y</span>) </span>{
            <span class="hljs-keyword">var</span> shapeid = el.id.substr(<span class="hljs-number">8</span>);
            <span class="hljs-keyword">return</span> shapeid;
        },

        <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.rendered) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-81" id="section-81"></a>
</div>
<p>batch the intial render into a single repaint</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                <span class="hljs-keyword">this</span>.group.innerHTML = <span class="hljs-keyword">this</span>.prerender;
                <span class="hljs-keyword">this</span>.rendered = <span class="hljs-literal">true</span>;
            }
        }
    });

}))}(<span class="hljs-built_in">document</span>, <span class="hljs-built_in">Math</span>));

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
